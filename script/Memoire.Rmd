---
title: 'Discrimination sur le marché du travail : le cas des immigrants du Québec'
author: "Frantz Roby POINT DU JOUR"
date_pub: "Publié le `r Sys.Date()`" #"2023-07-06"
#date_mod: "Modifié le `r Sys.Date()`"
output: 
  bookdown::html_document2:
    toc: TRUE
    toc_float: true
    number_sections: TRUE
    fig_caption: TRUE
    css: "memoire.css"
#  html_document:
#    toc: TRUE
#    number_sections: TRUE
#    fig_caption: true
#  pdf_document: 
#    toc: TRUE
#    number_sections: TRUE
#    fig_caption: true
    #latex_engine: xelatex
#  word_document:
#    toc: TRUE
#    number_sections: TRUE
 #   fig_caption: true
    
header-includes:
  \usepackage{caption}
bibliography: references.bib
link-citations: yes
---

```{r setup, include=FALSE}
#Load required libraries and configure parameters

knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
options(digits = 8/2, scipen = 00)
library(tidyverse)
library(knitr)
library(flextable)
library(kableExtra)
library(FactoMineR)
library(ggplot2)
library(ggthemes)
library(scales)
library(gridExtra)
library(oaxaca)
library(ggrepel)
library(ggforce)
set_flextable_defaults(fonts_ignore = TRUE, digits = 3)
```

```{r loadbase}
#Load the database

base <- read.csv("../base/pub0422.csv")
db <- data.frame(ID = base$REC_NUM, SURVYEAR = base$SURVYEAR, SURVMNTH = base$SURVMNTH,
                    PROV = base$PROV, AGE = base$AGE_12, SEX = base$SEX, MARSTAT = base$MARSTAT,
                    EDUC = base$EDUC, IMMIG = base$IMMIG, PAID = if_else(!is.na(base$HRLYEARN), 1, 0),
                    CATWORK = if_else(base$COWMAIN == 1 | base$COWMAIN == 2, 1, 2), 
                    UNEMP = if_else(!is.na(base$DURUNEMP), 1, 0), OCCUP = base$NOC_10,
                    WTIME = base$FTPTMAIN, TENURE = base$TENURE, UNION = base$UNION, 
                    FIRMSIZE = base$FIRMSIZE, HRLYEARN = base$HRLYEARN, DURUNEMP = base$DURUNEMP)
```

```{r transform}
# Create and format variables

attach(db)

db$YOUNG <- factor(if_else(AGE < 3, 1, 0))
db$WOMAN <- factor(if_else(SEX == 1, 0, 1))
db$MARRIED <- factor(if_else(MARSTAT == 1, 1, 0))
db$EDUC.LEVEL <- factor(if_else(EDUC < 3, 0, if_else(EDUC < 5, 1, 2)))
db$IMMIGRANT <- factor(if_else(IMMIG != 3, 1, 0))
db$ISPAID <- factor(PAID)
db$SELF.EMP <- factor(if_else(CATWORK == 1, 0, 1))
db$PART.TIME <- factor(if_else(WTIME == 2, 1, 0))
db$SYNDIC <- factor(if_else(UNION != 3, 1, 0))
db$LARGFIRM <- factor(if_else(FIRMSIZE == 4, 1, 0))
db$ISUNEMP <- factor(UNEMP)
db$LONG.UNEMP <- factor(if_else(DURUNEMP >= 52, 1, 0))
db$OCCUP.SEC <- factor(OCCUP)
db$OCCUP.SEC <- factor(OCCUP, levels = c(7, 1, 2, 3, 4, 5, 6, 8, 9, 10))
db$SAL <- HRLYEARN/100
db$YRS.TENURE <- db$TENURE/12

db$PROVINCE <- factor(PROV, labels = c("Terre-Neuve-et-Labrador", "Île-du-Prince-Édouard", "Nouvelle-Écosse", "Nouveau-Brunswick", 
                                         "Québec", "Ontario", "Manitoba", "Saskatchewan", "Alberta", "Colombie-Britannique"))
db$LN.SAL <- log(db$SAL)
```

```{r}
### Describe the variables that will be used in the model

descrip <- data.frame(Variable=names(select(db,c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME",
                                                 "SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP","OCCUP.SEC","HRLYEARN","DURUNEMP"))), 
                      Description=c("Catégorie d’âge de l’individu : (1) si âgé de moins de 30 ans ; (0) sinon.",
                                    "Genre femme : (1) s’il s’agit d’une femme ; (0) pour un homme.",
                                    "Statut matrimonial : (1) si marié ; (0) sinon.",
                                    paste0("Niveau d’éducation : (0) faible [études secondaires ou moins] ; (1) moyen [études ",
                                           "post-secondaires inférieures au baccalauréat] ; (2) élevé [diplôme de baccalauréat ",
                                           "ou plus]"),
                                    "Statut d’immigrant : (1) si la personne est immigrante ; (0) si la personne est née au Canada.",
                                    "(1) si la personne perçoit un salaire ; (0) sinon.",
                                    paste0("Statut de travailleur autonome : (1) si le répondant est travailleur autonome ; ",
                                           "(0) s’il s’agit d’un employé."),
                                    "Temps de travail : (1) temps partiel ; (0) temps plein.",
                                    paste0("(1) Si la personne est membre d’un syndicat ou couverte par une convention collective ",
                                           "négociée par un syndicat ; (0) sinon."),
                                    paste0("Taille de l’entreprise employeuse : (1) pour les grandes firmes de plus de 500 employés",
                                           "; (0) pour les plus petites entreprises."),
                                    "(1) Si la personne est au chômage ; (0) sinon.",
                                    "(1) Pour les personnes en recherche d’emploi depuis au moins 12 mois -> chômage long ; (0) sinon.",
                                    paste0("Catégories professionnelles selon le système de classification nationale : (1) Gestion ",
                                           "(2) Affaires, finance et administration (3) Sciences naturelles et appliquées et ",
                                           "domaines apparentés (4) Secteur de la santé (5) Enseignement, droit et services ",
                                           "sociaux, communautaires et gouvernementaux (6) Arts, culture, sports et loisirs ",
                                           "(7) Vente et services (8) Métiers, transport, machinerie et domaines apparentés ",
                                           "(9) Ressources naturelles, agriculture et production connexe ",
                                           "(10) Fabrication et services d'utilité publique"),
                                    "Salaire horaire habituel (en dollar canadien)",
                                    "Durée de l'emploi avec l'employeur actuel (en années)"))

#tab1 <- descrip %>% flextable() %>% set_caption("Description des variables") %>% width(j = 2, width = 6)
#tab1 <- knitr::kable(descrip, caption = "Description des variables", "simple") #fit html
#tab1
#tab1 <- descrip %>% regulartable() %>% autofit() %>% width(j=~Variable, width = 1) %>% width(j=~Description, width = 5.4) %>% set_caption("Description des variables") #for fitting PDF doc
```

```{r extractdb}
# Filter the database and extract data for Quebec Province

baseQC <- db %>% filter(PROVINCE == "Québec") %>% select(c(20:34,36))
```

```{r}
# Descriptive statistics

attach(baseQC)
obs = count(baseQC) #nombre d'observations

stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP*"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))

stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
                    n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
                    prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))

stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))

#tab2 <- knitr::kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% #kable_styling(), kable(stat3) %>% kable_styling())), caption = paste0("Statistique #descriptive ", "(N = ", obs, ")")) %>% kable_styling()

#paste0("Taille de la BD = ", count(baseQC))
#tab2 <- knitr::kable(list(stat1, stat2, stat3), caption = 'Statistique descriptive', booktabs = TRUE, valign = 't')   #for fitting PDF doc

#tab2
```

```{r}
#Multicomponent analysis

varACM <- subset.data.frame(baseQC, 
                            select = c("WOMAN", "YOUNG", "MARRIED", "EDUC.LEVEL", "IMMIGRANT", "SELF.EMP", "SYNDIC", "OCCUP.SEC",
                                       "PART.TIME", "LARGFIRM", "ISUNEMP", "LONG.UNEMP", "YRS.TENURE", "SAL"))
res.mca <- MCA(varACM, quali.sup = c(6:12), quanti.sup = c(13, 14), graph = FALSE)

#Showing the main variables
p0 <- plot(res.mca, invisible = c("ind", "quali.sup"), habillage = "quali", cex = 0.9, selectMod = "cos2 20")
p0 <- p0 + labs(caption = "©FRPDJ, Source:StatCan-04/2022", title = NULL, subtitle = "A- Variables principales") + theme(plot.title = element_text(size = 12)) #french version
#p0
#p0 <- p0 + labs(title = "Showing the main variables in the MCA plan", caption = "©FRPDJ, Source:StatCan-04/2022") + theme(plot.title = element_text(size = 12))
#english version
#p0

#Schowing the supplementary qualitative variables
p1 <- plot(res.mca, invisible = c("ind", "var"), habillage = "quali", cex = 0.9, selectMod = "cos2 20")
p1 <- p1 + labs(caption = "©FRPDJ, Source:StatCan-04/2022", title = NULL, subtitle = "B- Variables supplémentaires") + 
  theme(plot.title = element_text(size = 12)) #french version
#p1
#p1 <- p1 + labs(title = "Showing the supp. quali. variables in the  MCA plan", caption = "©FRPDJ, Source:StatCan-04/2022") + 
#  theme(plot.title = element_text(size = 12)) #english version
#p1
```

```{r}
#Multicomponent analysis - all (main and supp) variables

#p1b <- plot(res.mca, invisible = c("ind"), habillage = "quali", cex = 0.9, selectMod = "cos2 20")
#p1b <- p1b + labs(caption = "©FRPDJ, Source:StatCan-04/2022", title = NULL) + theme(plot.title = element_text(size = 12)) #french version
#p1b
#p1b <- p1b + labs(title = "Showing the all variables (main and supp) in the MCA plan", caption = "©FRPDJ, Source:StatCan-04/2022") + theme(plot.title = element_text(size = 12))
#english version
#p1b
```

```{r setdata1}
#Compare mean salary between immigrants and canadian born citizens - ttest

mean_nat <- round(mean(baseQC$SAL[IMMIGRANT==0], na.rm = TRUE), 1)
mean_im <- round(mean(baseQC$SAL[IMMIGRANT==1], na.rm = TRUE), 1)
med_nat <- round(median(baseQC$SAL[IMMIGRANT==0], na.rm = TRUE), 1)
med_im <- round(median(baseQC$SAL[IMMIGRANT==1], na.rm = TRUE), 1)
tmoy <- t.test(baseQC$SAL ~ baseQC$IMMIGRANT)  #test de moyenne de salaire entre immigrants et natifs
tmoy_pvalue <- round(tmoy$p.value, 4) #p-value du test de moyenne
```

```{r}
#Compare salary distribution in immigrants and canadian born citizens population sample

p2 <- baseQC %>% filter(!is.na(SAL) & !is.na(IMMIGRANT)) %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 <- p2 + geom_boxplot() + 
  labs(subtitle = "A- boîtes à moustaches", caption = "©FRPDJ, Source:StatCan") + #french version
  #labs(title = "Hourly wage distribution in Quebec (boxplot)", caption = "©FRPDJ, Source:StatCan") + #english version
  theme_fivethirtyeight() + 
  theme(legend.position="none", axis.text = element_text(size = 12)) + 
  scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + 
  geom_hline(yintercept = mean_nat, col = "red") +
  geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + 
  geom_hline(yintercept = mean_im, col = "blue") + 
  geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
#p2

p3 <- baseQC %>% filter(!is.na(SAL) & !is.na(IMMIGRANT)) %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 <- p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + 
  scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + 
  labs(subtitle = "B- courbes de densité", caption = "©FRPDJ, Source:StatCan-04/2022") + #french version 
  #labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + #english version
  theme_fivethirtyeight() + 
  theme(axis.text = element_text(size = 12), legend.text =  element_text(size = 12)) + 
  scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
#p3

```

```{r setdata2}
#Compare unemployment rate between immigrants and canadian born citizens

chom <- baseQC %>% group_by(IMMIGRANT, ISUNEMP) %>% summarise(n = n()) %>% group_by(IMMIGRANT) %>% summarise(ISUNEMP = ISUNEMP, n = n, prop = n/sum(n)) %>% filter(ISUNEMP==1)

rc_nat <- chom %>% filter(IMMIGRANT==0) %>% .$prop %>% percent(0.1)
rc_im <- chom %>% filter(IMMIGRANT==1) %>% .$prop %>% percent(0.1)

lchom <- baseQC %>% group_by(IMMIGRANT, LONG.UNEMP) %>% summarise(n = n()) %>% group_by(IMMIGRANT) %>% summarise(LONG.UNEMP = LONG.UNEMP, n = n, prop = n/sum(n)) %>% filter(LONG.UNEMP==1)

rlc_nat <- lchom %>% filter(IMMIGRANT==0) %>% .$prop %>% percent(0.1)
rlc_im <- lchom %>% filter(IMMIGRANT==1) %>% .$prop %>% percent(0.1)

x2_chom <- chisq.test(baseQC$IMMIGRANT, baseQC$ISUNEMP)
x2_lchom <- chisq.test(baseQC$IMMIGRANT, baseQC$LONG.UNEMP)
x2_chom_p <- round(x2_chom$p.value, 5)
x2_lchom_p <- round(x2_lchom$p.value, 4)
```

```{r}
#Compare unemployment rate between immigrants and canadian born citizens - figure

p4 <- chom %>% ggplot()
p4 <- p4 + geom_bar(data = chom, aes(IMMIGRANT, prop, fill = "UNEMP"), stat = "identity", width = 0.5) + 
  geom_bar(data = lchom, aes(IMMIGRANT, prop, fill = "LONG UNEMP"), col = "gray", stat = "identity", width = 0.5) + 
  scale_fill_manual(name='', breaks=c('UNEMP', 'LONG UNEMP'), values=c('UNEMP'='#E69F00', 'LONG UNEMP'='#D55E00')) +
  labs(caption = paste("UNEMP chi2 (α=", x2_chom_p,"); LONG UNEMP chi2 (α=", x2_lchom_p,
                       ")\n\n©FRPDJ, Source:StatCan-04/2022")) + #french version
  #labs(title = "Proportion of unemployment by group", caption = "©FRPDJ, Source:StatCan-04/2022") + #english version
  theme_fivethirtyeight() +
  theme(axis.text = element_text(size = 12), legend.text =  element_text(size = 12)) + 
  scale_x_discrete(name="", labels=c("Canadian born", "Immigrant"))
#p4
```

```{r ols}
#OLS regression of the salary

baseQC.paid <- baseQC %>% filter(ISPAID == 1)  #Filtrage des donnees des salariés au Quebec

reg1 <- lm(LN.SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + IMMIGRANT + 
             OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM, data = baseQC.paid)
sumreg1 <- summary(reg1)
conf1 <- data.frame(confint(reg1, level=0.95)) %>% rename(b_inf=X2.5.., b_sup= X97.5..)

# Construction du tableau des résultats de la régression 
tot <- data.frame(variable = c("intercept", "YOUNG", "WOMAN", "MARRIED", "EDUC.LEVEL_1","EDUC.LEVEL_2", "IMMIGRANT", 
                               "OCCUP.SEC_1", "OCCUP.SEC_2", "OCCUP.SEC_3", "OCCUP.SEC_4", "OCCUP.SEC_5", "OCCUP.SEC_6", "OCCUP.SEC_8", 
                               "OCCUP.SEC_9", "OCCUP.SEC_10", "PART.TIME", "YRS.TENURE", "SYNDIC", "LARGFIRM"), 
                  estim_coef = sumreg1$coefficients[ , 1], inf = conf1$b_inf, 
                  sup = conf1$b_sup, p_value = sumreg1$coefficients[ , 4]) %>% 
  mutate(sign = if_else(p_value < 10^-3,"*",if_else(p_value < .05,".",""))) %>% 
  filter(variable != "intercept")

# Coefficients estimés pour les niveaux d'éducation
educ <- tot[4:5,] %>% mutate(label = c("L1: Postsecondary studies below bachelor degree", "L2: Bachelor degree or higher")) %>%
  mutate(variable = reorder(variable, estim_coef, FUN = median))

# Coefficients estimés pour les secteurs d'activité
occup <- tot[7:15,] %>% mutate(label = c("S1: Management", "S2: BAF",
                                         "S3: Applied sciences", "S4: Health",
                                         "S5: Education, social serv.",
                                         "S6: Art, culture",
                                         "S8: Trades, transport",
                                         "S9: Agriculture",
                                         "S10: Manufacturing")) %>% 
  mutate(variable = reorder(variable, estim_coef, FUN = median))

# Coefficients estimés pour les autres variables
other <- tot[c(1:3,6,16:19),] %>% mutate(variable = reorder(variable, estim_coef, FUN = median))
```

```{r}
#OLS regression of the salary - estimated parameters - graph1

p5 <- other %>% ggplot()
p5 <- p5 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + 
  geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + 
  geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.2) + 
  theme_economist_white() + 
  geom_hline(yintercept = 0, col="red") + 
  scale_x_discrete(name = "") + scale_y_continuous(name="Ln(wage) OLS estimates") +
  theme(axis.text.x = element_text(size = 12, angle=60, hjust=1, vjust=1),
        axis.text.y = element_text(size = 12)) + 
  labs(#title = "Structure des salaires au Quebec", #french version
       #subtitle = "\n Croissance des salaires vs caractéristiques individuelles \n", #french version
       #title = "The wage structure in Quebec",
       #subtitle = "\n Impact of individual caracteristics on wage growth \n", 
       caption = paste0("(*): p-value < 0.001 \n", 
                        "N=", sumreg1$df[2]+sumreg1$df[3], "; df=", sumreg1$df[2], 
                        "; R^2=", round(sumreg1$r.squared,2), 
                        "\n \n ©FRPDJ, Source: StatCan_EPA-04/22"))
#p5
```

```{r}
#OLS regression of the salary - estimated parameters - graph2

p6 <- educ %>% ggplot()
p6 <- p6 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + 
  geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + 
  geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.1) + 
  geom_point(aes(x = variable, y = estim_coef, col = label), alpha = 0) + 
  theme(plot.title = element_text(size = 18, face = "bold"), plot.subtitle = element_text(size = 13),
        axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12), 
        legend.text = element_text(size = 11), legend.position = "bottom", 
        panel.grid.major.y = element_line(color = "darkgrey", linetype = "solid"), 
        panel.grid.minor.y = element_line(colour = "grey50", linetype = "dashed"), 
        panel.background = element_rect(fill = "white")) + 
  geom_hline(yintercept = 0, col="red") + 
  scale_x_discrete(name = "", labels = c("L1", "L2")) + 
  scale_y_continuous(name="Ln(wage) OLS estimates") + scale_color_discrete(name="") + 
  labs(#title = "Structure des salaires au Quebec : croissance des salaires vs niveau d'éducation", #french version
       #subtitle = "\n Niveau de référence : travailleurs avec éducation secondaire ou inférieure \n", #french version
       #title = "Wage structure in Quebec: impact of education on wage growth", 
       #subtitle = 'Reference: Workers with Secondary education or below', 
       caption = paste0("(*): p-value < 0.001 \n", 
                        "N=", sumreg1$df[2]+sumreg1$df[3], "; df=", sumreg1$df[2], 
                        "; R^2=", round(sumreg1$r.squared,2), 
                        "\n \n ©FRPDJ, Source: StatCan_EPA-04/22"))
#p6
```

```{r}
#OLS regression of the salary - estimated parameters - graph3

p7 <- occup %>% ggplot()
p7 <- p7 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + 
  geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + 
  geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.2) + 
  geom_point(aes(x = variable, y = estim_coef, col = label), alpha = 0) + 
  geom_hline(yintercept = 0, col="red") + scale_x_discrete(name = "", labels = c("S10", "S9","S2","S6","S8","S4","S5","S3","S1")) + 
  scale_y_continuous(name="Ln(wage) OLS estimates") + 
  scale_color_discrete(name="Sectors") + 
  theme(plot.title = element_text(size = 18, face = "bold"), plot.subtitle = element_text(size = 13),
        axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), 
        legend.text = element_text(size = 11), legend.position = "right", 
        panel.grid.major.y = element_line(color = "darkgrey", linetype = "solid"), 
        panel.grid.minor.y = element_line(colour = "grey50", linetype = "dashed"), 
        panel.background = element_rect(fill = "white")) + 
  labs(#title = "Structure des salaires au Quebec : comparaison des secteurs d'activités", #french version
       #subtitle = "\n Niveau de référence : secteur des ventes et services \n", #french version
       #title = "Wage structure in Quebec: comparing employment sectors", 
       #subtitle = 'Reference level is the sector of Sales and services', 
       caption = paste0("(*): p-value < 0.001 \n", 
                        "N=", sumreg1$df[2]+sumreg1$df[3], "; df=", sumreg1$df[2], 
                        "; R^2=", round(sumreg1$r.squared,2), 
                        "\n \n ©FRPDJ, Source: StatCan_EPA-04/22"))
#p7
```

```{r oaxaca}
#Decompose the salary gap between immigrants and canadian born citizen - Oaxaca regression
baseQC.paid$T.IMMIG <- with(baseQC.paid, IMMIGRANT == 1)    #Variables de type 'logical'

results <- oaxaca(formula = SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + 
                    OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM | T.IMMIG, 
                  data = baseQC.paid, R = 100)
```

```{r ecartSal}
#Oaxaca decomposition results

oaxacaResume <- data.frame()
oaxacaResume <- data.frame(n = c(paste("A",results$n$n.A,sep = "\n"), 
                        paste("B",results$n$n.B, sep = "\n"), 
                        paste("pooled",results$n$n.pooled, sep = "\n")), 
                  y = c(paste("A",round(results$y$y.A, 2), sep = "\n"), 
                        paste("B",round(results$y$y.B, 2), sep = "\n"),
                        paste("diff",round(results$y$y.diff, 2), sep = "\n")),
                  twofold = c(paste("explained", round(results$twofold$overall[2,2], 2), sep = "\n"),
                              paste("unexplained", round(results$twofold$overall[2,4], 2), sep = "\n"),
                              paste0("")),
                  threefold = c(paste("endowments", round(results$threefold$overall[1], 2), sep = "\n"), 
                                paste("coefficients", round(results$threefold$overall[3], 2), sep = "\n"), 
                                paste("interaction", round(results$threefold$overall[5], 2), sep = "\n")))
```

```{r}
#Oaxaca decomposition results - graph

discrim <- data.frame(gap_type = c("Observed", "Expected", "Unexplained"), 
                      value = c(results$y$y.diff, results$twofold$overall[2,2], results$twofold$overall[2,4]))

p8 <- discrim %>% ggplot(aes(gap_type, value, fill = c("col1", "col2", "col3"))) + 
    geom_col(width = .95, position = "dodge") + 
  geom_text(aes(label=round(value,2))) +
    scale_fill_manual(values = c("col1"="#CC79A7","col2"="#009E73","col3"="#D55E00")) + 
    scale_x_discrete(name = "Wage Gap", limits=c("Unexplained", "Observed", "Expected")) +
    ylab("") +
    theme_fivethirtyeight() +
    theme(axis.text = element_text(size = 11), legend.position = "none", aspect.ratio = .4, 
          panel.background =element_rect(fill = "white"), plot.background = element_rect(fill = "white")) + 
    coord_flip() +
    labs(#title = "Structure des salaires au Quebec", #french version
         #subtitle = "\n Décomposition de l'écart salarial natifs (A) vs immigrants (B) \n", #french version
         #title = "The wage structure in Quebec", 
         #subtitle = 'Decomposing the wage gap between Canadian born citizens (A) and Immigrants (B)', 
         caption = "Method: Blinder-Oaxaca \n \n ©FRPDJ, Source: StatCan_EPA-04/22")
#p8
```

```{r}
#graphe de la formation des ecarts expliqués par les différences de caractéristiques

p9 <- plot(results, components = c("endowments")) #+ ggtitle("Impact of workers' characteristics on wage gap")
#p9
```

```{r}
#graphe de la formation des ecarts expliqués par le modèle

p10 <- plot(results, decomposition = "twofold", group.weight = 1, components = c("explained")) #+ ggtitle("Impact of workers' #characteristics and interactions on wage gap") 
#p10
#round(results$twofold$variables[[2]][,2:3],3)   #coefficients de la formation des ecarts expliqués par le modèle
```

```{r logit}
# Logistic Regression of the unemployment 

reg2 <- glm(ISUNEMP ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + IMMIGRANT + SELF.EMP, family = binomial(link = "logit"), baseQC)

sumreg2 <- summary(reg2)
conf2 <- data.frame(confint(reg2, level=0.95)) %>% rename(b_inf=X2.5.., b_sup= X97.5..)

tot2 <- data.frame(estim_coef = sumreg2$coefficients[ , 1], inf = conf2$b_inf, 
                  sup = conf2$b_sup, p_value = sumreg2$coefficients[ , 4]) %>% 
  mutate(sign = if_else(p_value < 10^-3, "***", if_else(p_value < 0.01, "**", if_else(p_value < 0.05, "*",
                                                       if_else(p_value < 0.1,".",""))))) %>%
  mutate(variable = c("intercept", "YOUNG", "WOMAN", "MARRIED", "EDUC.LEVEL_1","EDUC.LEVEL_2", "IMMIGRANT", "SELF.EMP"), .before = 1) %>%
  filter(variable != "intercept") %>%
  mutate(variable = reorder(variable, estim_coef, FUN = median))
tot2 <- tot2 %>% mutate(odds = exp(estim_coef))
```

```{r}
#Logistic Regression of the unemployment - graph

p11 <- tot2 %>% ggplot()
p11 <- p11 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + 
  geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + 
  geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.2) + 
  theme_economist_white() + 
  geom_hline(yintercept = 0, col="red") + 
  scale_x_discrete(name = "") + scale_y_continuous(name="Logit estimates") +
  theme(axis.text.x = element_text(size = 12, angle=60, hjust=1, vjust=1),
        axis.text.y = element_text(size = 12)) + 
  labs(#title = "Les déterminants individuels de la probabilité d'être au chômage au Quebec", #french version
       #title = "Individual factors influencing unemployment status in Quebec",
       caption = paste0("(***): p-value < 0.001; (**): p-value < 0.01; (*): p-value < 0.05; (.): p-value < 0.1 \n", 
                        "N=", sumreg2$df[2]+sumreg2$df[3], "; df=", sumreg2$df[2], 
                        "; AIC=", round(sumreg2$aic), 
                        "\n \n ©FRPDJ, Source: StatCan_EPA-04/22"))
#p11
```

```{r fairlie}
#Decomposition de l'écart (natif - immigrant) de prob chomage (methode Fairlie)
#1.1-Vérification des différences de caractéristiques des natifs (A) vs les immigrants (B)

prop.B <- baseQC %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==1) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

prop.A <- baseQC %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==0) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

ecartAB = prop.A - prop.B

tot3 <- data.frame(prop.A = prop.A, prop.B = prop.B, ecartAB = ecartAB) %>% add_column(variable = c("ISUNEMP","YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","SELF.EMP"), .before = 1)
```

```{r ecartChom}
# 2- Regression logit dans le groupe des natifs (groupe A)

reg4 <- glm(ISUNEMP ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + SELF.EMP, family = binomial(link = "logit"),
            data=baseQC[baseQC$IMMIGRANT == "0",])

# 3- On predit les probabilités à partir des estimateurs des natifs (groupe A)
baseQC$pA <- predict(reg4, baseQC, type = 'response')

prop.cB <- mean(baseQC$pA[baseQC$IMMIGRANT == "1"], na.rm = TRUE)      #probabilité que les immigrants soient au chômage si leurs caractéristiques sont valorisées comme celles des natifs
prop.cB.pc <- prop.cB %>% percent(0.1) #proba chomâge hypothéthique immigrant en pourcentage
prop.B.pc <- tot3$prop.B[1] %>% percent(0.1) #proba chomâge observé immigrant en pourcentage
prop.A.pc <- tot3$prop.A[1] %>% percent(0.1) #proba chomâge observé natif en pourcentage

expl <- tot3$prop.A[1] - prop.cB #Ecart expliqué
inexpl <- prop.cB - tot3$prop.B[1] #Ecart inexpliqué

# Construction du tableau de résultats
tot4 <- data.frame(gap_type=c("Observed", "Expected", "Unexplained"), value=c(ecartAB[1], expl, inexpl))
```

```{r}
#Decompose the unemployment rate gap betwenn immigrants and canadian born citizens - graph

p12 <- tot4 %>% ggplot(aes(gap_type, value, fill = c("col1", "col2", "col3"))) + 
    geom_col(width = .95, position = "dodge") + geom_text(aes(label=value%>%percent(.1))) + 
    scale_fill_manual(values = c("col1"="#CC79A7","col2"="#009E73","col3"="#D55E00")) + 
    scale_x_discrete(name = "Wage Gap", limits=c("Unexplained", "Observed", "Expected")) +
    ylab("") +
    theme_fivethirtyeight() +
    theme(axis.text = element_text(size = 11), legend.position = "none", aspect.ratio = .4, 
          panel.background =element_rect(fill = "white"), plot.background = element_rect(fill = "white")) + 
    coord_flip() +
    labs(#title = "Décomposition de l'écart de probabilité de chômage au Québec", #french version
         #subtitle = "\n Natifs (A) vs immigrants (B) \n", #french version
         #title = "Unemployment rate in Quebec", 
         #subtitle = 'Decomposing the gap between Canadian born citizens (A) and Immigrants (B)', 
         caption = "Method: Fairlie \n \n ©FRPDJ, Source: StatCan_EPA-04/22")
#p12
```

```{r regOaxacaAllSal}
#Salary discrimination - Comparing different canadian provinces

base.paid <- db %>% filter(ISPAID == 1)
base.paid$T.IMMIG <- with(base.paid, IMMIGRANT == 1)    #Variables de type 'logical'

baseBC.paid <- base.paid %>% filter(PROV==59)
baseMB.paid <- base.paid %>% filter(PROV==46)
baseON.paid <- base.paid %>% filter(PROV==35)

resultsBC <- oaxaca(formula = SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + 
                    OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM | T.IMMIG, 
                  data = baseBC.paid, R = 100)
resultsMB <- oaxaca(formula = SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + 
                    OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM | T.IMMIG, 
                  data = baseMB.paid, R = 100)
resultsON <- oaxaca(formula = SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + 
                    OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM | T.IMMIG, 
                  data = baseON.paid, R = 100)
```

```{r regFairlieAllChom}
#Employment access discrimination - Comparing different canadian provinces
baseBC <- db %>% filter(PROV==59)
baseMB <- db %>% filter(PROV==46)
baseON <- db %>% filter(PROV==35)

# 1- Caractéristiques des natifs (groupe A) vs les immigrants (groupe B)
prop.B_BC <- baseBC %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==1) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

prop.A_BC <- baseBC %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==0) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

ecartAB_BC <- prop.A_BC - prop.B_BC 

prop.B_MB <- baseMB %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==1) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

prop.A_MB <- baseMB %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==0) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

ecartAB_MB <- prop.A_MB - prop.B_MB

prop.B_ON <- baseON %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==1) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

prop.A_ON <- baseON %>% mutate(EDUC.LEVEL_0=if_else(EDUC.LEVEL==0,1,0), EDUC.LEVEL_1=if_else(EDUC.LEVEL==1,1,0), EDUC.LEVEL_2=if_else(EDUC.LEVEL==2,1,0)) %>% select(IMMIGRANT,ISUNEMP,YOUNG,WOMAN,MARRIED,EDUC.LEVEL_0,EDUC.LEVEL_1,EDUC.LEVEL_2,SELF.EMP) %>% filter(IMMIGRANT==0) %>% .[2:9] %>% apply(2, function(x) as.numeric(as.character(x))) %>% colMeans(na.rm = TRUE)

ecartAB_ON <- prop.A_ON - prop.B_ON 


# Regression logit dans les groupes des natifs (groupe A) des differentes provinces
reg5 <- glm(ISUNEMP ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + SELF.EMP, family = binomial(link = "logit"),
            data=baseBC[baseBC$IMMIGRANT == "0",])
reg6 <- glm(ISUNEMP ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + SELF.EMP, family = binomial(link = "logit"),
            data=baseMB[baseMB$IMMIGRANT == "0",])
reg7 <- glm(ISUNEMP ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + SELF.EMP, family = binomial(link = "logit"),
            data=baseON[baseON$IMMIGRANT == "0",])

# Pour chaque province, on prédit les probabilités à partir des estimateurs des natifs (groupe A)
baseBC$pA <- predict(reg5, baseBC, type = 'response')
baseMB$pA <- predict(reg6, baseMB, type = 'response')
baseON$pA <- predict(reg7, baseON, type = 'response')

# Probabilités que les immigrants soient en chômage si leurs caractéristiques sont valorisées comme celles des natifs, dans les différentes provinces
prop.cB_BC <- mean(baseBC$pA[baseBC$IMMIGRANT == "1"], na.rm = TRUE)
prop.cB_MB <- mean(baseMB$pA[baseMB$IMMIGRANT == "1"], na.rm = TRUE)
prop.cB_ON <- mean(baseON$pA[baseON$IMMIGRANT == "1"], na.rm = TRUE)

#Ecart de proba de chômage expliqué par les différences de caractéristiques
#expl <- prop.A[2] - prop.cB 
expl_BC <- prop.A_BC[1] - prop.cB_BC
expl_MB <- prop.A_MB[1] - prop.cB_MB
expl_ON <- prop.A_ON[1] - prop.cB_ON

#Ecart de proba de chômage inexpliqué par les modèles
#inexpl <- prop.cB - prop.B[2] #Ecart inexpliqué
inexpl_BC <- prop.cB_BC - prop.B_BC[1]
inexpl_MB <- prop.cB_MB - prop.B_MB[1]
inexpl_ON <- prop.cB_ON - prop.B_ON[1]
```

```{r regAllTab}
#Salary and Employment access discrimination - Comparing different canadian provinces
tab_all <- data.frame(PROV = c("QC","BC","MB","ON"), 
                      UNEXP_SAL = c(results$twofold$overall[2,4], resultsBC$twofold$overall[2,4],
                                resultsMB$twofold$overall[2,4], resultsON$twofold$overall[2,4]),
                      UNEXP_pCHOM = c(inexpl,inexpl_BC,inexpl_MB, inexpl_ON) )
```

```{r}
#Salary and Employment access discrimination - Comparing different canadian provinces - graph
p13 <- tab_all %>% ggplot(aes(UNEXP_pCHOM, UNEXP_SAL, label=PROV)) + geom_point(size=4, aes(col=PROV)) +
  ggrepel::geom_text_repel(aes(col=PROV)) +
  geom_vline(xintercept = 0) + geom_hline(yintercept = 0) + 
  scale_x_continuous(limits = c(-0.025, 0.025)) + 
  scale_y_continuous(limits = c(0, 6)) + 
  theme_economist_white() + 
  theme(legend.position = "none", axis.text = element_text(size = 12), legend.text =  element_text(size = 12))+
  labs(#title = "Labor market discrimination toward immigrants in Canada", 
       #subtitle="\nComparing Quebec to other Provinces\n", 
       caption = "©FRPDJ, Source:StatCan-04/2022") # + geom_mark_circle(aes(filter=PROV!=c("MB","ON")), fill="lightblue")
#p13
```

# RESUMÉ {.unnumbered}

Cette étude dresse une comparaison entre les immigrants et les natifs dans la province du Québec au Canada, en ce qui a trait à l'accès à l'emploi et à la rémunération salariale. L'accès à l'emploi est mesuré en termes de probabilité d'être au chômage et la rémunération en termes de salaire horaire perçu par l'individu. Nous utilisons pour cela des méthodes de régression linéaire et logistique ainsi que des méthodes de décomposition des inégalités observées entre les groupes (méthode Oaxaca-Blinder et méthode Fairlie). Les résultats de notre recherche prouvent l'existence d'une discrimination à l'encontre des immigrants québecois tant au niveau de l'accès à l'emploi que de la rémunération. Au niveau de l'accès à l'emploi, un immigrant a 1,5 fois plus de chance d'être au chômage qu'un natif. Il y a un surplus de probabilité de chômage de 1.8% chez les immigrants qui ne s'explique que par une discrimination purement négative à l'encontre de ces derniers. Au niveau de la rémunération, un immigrant gagne un salaire horaire 10% inférieur à celui d'un natif, toutes choses égales par ailleurs. Il y a un écart inexpliqué de 3,5\$ entre le salaire horaire moyen que les immigrants auraient dû recevoir et ce qu'ils reçoivent dans la réalité. Ces résultats appellent à un renforcement des politiques d'insertion professionnelle et de lutte contre les discriminations à l'endroit des immigrants au Québec. Pour s'améliorer, le Québec peut s'inspirer d'autres provinces canadiennes comme le Manitoba qui n'affiche aucune discrimination contre les immigrants au niveau de l'accès à l'emploi, et l'Ontario où la discrimination salariale est beaucoup plus faible.

\newpage

# INTRODUCTION

La discrimination envers des groupes d'individus sur le marché du travail reste un sujet d'actualité. Alors que tous les gouvernements poursuivent leurs objectifs de création d'emplois et de croissance économique, il en résulte évidemment un enjeu d'inégalité et d' injustice sociale. Il arrive en effet que des employeurs accordent des traitements inéquitables aux individus, non pas sur la base des critères de productivité comme le niveau d'éducation ou la profession, mais en raison d'autres caractéristiques non productives telles que le sexe, l'origine ou l'apparence physique [@carcillo2018]. Cette situation reconnue comme de la discrimination s'avère être un frein important au développement des pays. Car au-delà de la croissance, il importe de considérer l'aspect qualitatif de l'évolution économique.

Avec les progrès technologiques et la mondialisation des économies, la migration des populations entre les régions et les pays est de plus en plus répandue. Ainsi plusieurs pays dont le Canada mettent en place des politiques migratoires d'envergure. Ces mesures visent à soutenir croissance démographique tout en favorisant la croissance et le développement économique. Parmi toutes les provinces canadiennes, le Québec est celle qui accorde une importance toute particulière à ses politiques migratoires en raison de ses objectifs en matière de protection de la langue française. Etant donné son passé singulier, la province jouit d'une exemption la permettant de choisir une grande majorité de ces immigrants en fonction des besoins précises de son économie.

Les immigrants québécois alors finement sélectionnés à partir d'un large éventail de programmes minutieusement conçus par le ministère de l'immigration du Québec (MIFI). Tous les candidats à l'immigration temporaire ou permanente au Québec doivent obligatoirement obtenir un certificat d'acceptation ou de sélection du MIFI pour être autorisés par le gouvernement fédéral à migrer au Canada. Il s'agit d'une mesure de contrôle qui devrait faciliter l'intégration des immigrants dans la province francophone. Cependant, si ses efforts de planification ont aidé à améliorer la situation des immigrants en termes de taux d'emploi et de chômage par exemple, de nombreuse interrogations se posent encore quant à l'intégration des immigrants sur le marché du travail [@aziaba2020; @guay2021] [^1].

[^1]: Aziaba (2020) rapporte une hausse de 6% du taux d'emploi et une baisse de 10% du taux de chômage chez les immigrants du principal groupe d'âge actif du Québec, entre 2006 et 2017.

Dans ce contexte, nous nous posons la question suivante : quel est le niveau d'intégration des immigrants au Québec en termes de rémunération salariale et d'accès à l'emploi ? Notre objectif est de déterminer s'il y a de la discrimination entre les personnes nées au Canada et les immigrants quant au montant du salaire horaire reçu et à la facilité d'accéder à un emploi. Plus spécifiquement, nous cherchons à :

1.  Déterminer si une personne immigrante au Québec est rémunérée au même niveau qu'une personne née au Canada.

2.  Vérifier si les immigrants ont un risque plus élevé de retrouver au chômage par rapport aux non-immigrants.

3.  Analyser l'impact des caractéristiques individuelles sur les écarts salariaux et les écart de probabilité de chômage entre immigrants et natifs.

4.  Comparer la situation des immigrants du Québec par rapport aux immigrants dans les autres provinces du Canada.

Le présent travail est structuré comme suit. Dans un premier temps, nous discutons de la littérature au sujet des facteurs déterminants dans l'accès à l'emploi et la rémunération. Nous nous basons sur ces éléments de discussion pour sélectionner des variables à intégrer dans la construction de nos modèles économétriques. Ces derniers sont présentés dans la deuxième section portant sur la méthodologie de l'étude. Nous y exposons également des méthodes de décomposition utilisées pour expliquer les inégalités mesurées entre les immigrants et les non-immigrants. La troisième section expose les résultats de notre recherche et leur analyse. Elle est suivie d'une conclusion sur les principales retombées des résultats de l'étude et les limites identifiées.

\newpage

# REVUE DE LITTÉRATURE

Dans cette section, nous faisons une brève discussion de la littérature concernant la discrimination sur le marché du travail notamment envers les immigrants.

## Les théories à la base de la discrimination

La littérature portant sur les explications théoriques de la discrimination est assez abondante. La discrimination est définie de plusieurs manières. Nous nous focalisons ici sur la discrimination économique. En général, on admet deux principaux types de discrimination :

-   Il y a la discrimination dite intentionnelle ou pure qui est dûment identifiée comme une décision de traiter inéquitablement un groupe d'individus par rapport à un autre. Comme le souligne @bon-maury2016, il s'agit ici d'une situation où la personne est traitée de manière moins favorable par rapport à une autre à cause de son appartenance ou de sa non-appartenance, vraie ou supposée, à un groupe comme une ethnie ou une race, un sexe, une religion, ou encore une origine. Cette vision est confortées par les travaux de @becker1971 pour qui la discrimination résulte d'un acte intentionnel de la part de l'employeur. Ce choix de l'employeur peut être dû à sa volonté de garder ses distances avec un groupe d'individus présentant des caractéristiques spécifiques, ou encore à ses préférences pour un groupe d'individus particulier. Cette volonté de discrimination observée chez l'employeur peut dépendre entièrement de lui-même, du goût partagé par ces employés, ou bien de la pression exercée par sa clientèle de consommateurs.
-   Par ailleurs, la discrimination peut être l'effet d'un acte non intentionnel. En effet, certaines dispositions ou pratiques apparemment neutres peuvent toujours entraîner un désavantage pour certaines personnes par rapport à d'autres [@bon-maury2016]. On retrouve ici les idées de @phelps1972 pour lequel les employeurs averses au risque sont conduits à faire des choix qui, en situation d'asymétrie d'information, sont forcément guidés par des croyances et génèrent donc une attitude discriminante.

Finalement, il faut reconnaitre que nous traitons ici d'un phénomène assez complexe à analyser. Car comme l'affirme @gazier2010, la discrimination est un phénomène multi-dimensionnel qui met en jeu des interactions entre de nombreux acteurs dans de nombreux domaines et selon de multiples modalités. Dans la littérature, trois approches sont généralement utilisées pour mesurer ce phénomène [@bon-maury2016] : les enquêtes de victimation où l'on mesure la perception des victimes de discrimination; la méthode testing qui met en évidence un traitement inégal dans une situation donnée; et la méthode statistique d'étude des écarts entre la situation d'un groupe discriminé et celle d'un groupe de référence. Cette dernière méthode concerne la méthodologie adoptée dans le cadre de cette étude et que nous exposeront à la prochaine section.

## Discrimination envers les immigrants

Plusieurs études soulèvent des cas de discrimination envers les immigrants sur des marché du travail dans certains pays. @aeberhardt2013 montrent par exemple que le marché du travail français est impacté par ce phénomène. Leur étude souligne l'existence d'écarts dans les salaires et les taux d'emploi entre les individus de descendance française et ceux dont les parents sont originaires du Maghreb, d'Afrique sub-saharienne et du Proche-Orient, voire des pays d'Europe du Sud. Aux Etats-Unis, @hersch2008 montre que même au sein du groupe des immigrants, il y a de la discrimination salariale sur la base de la couleur de leur peau, les noirs étant rémunérés à un niveau inférieur à celui de leurs homologues immigrants blancs.

Le marché du travail au Québec ne semble pas être épargné par les phénomène discriminatoire contre les immigrants, bien que la discrimination soit interdite légalement et condamnée dans cette province du Canada. Dans son étude mobilisant la méthode testing, @eid2012 étudie le comportement des recruteurs à l'égard des candidats à l'emploi à Montréal (Québec). Les résultats révèlent qu'à profil égal, un candidat majoritaire ayant un nom franco-québécois a au moins 60 % plus de chances d'être invité à un entretien qu'un candidat avec un nom arabe, latino-américain ou africain. Par ailleurs, ces derniers courent un plus grand risque d'être ignorés par l'employeur après leur entrevue, et cela sur une base discriminatoire. Dans une autre étude, @chicha2012 souligne qu'une proportion de plus en plus grande femmes immigrantes au Québec occupent des emplois peu qualifiés et cela de façon durable. L'auteure mobilise une approche qualitative pour expliquer comment des immigrantes détenant un diplôme universitaire dans leur pays d'origine subissent une déqualification lorsqu'elles s'établissent au Québec.

Les constats précédents justifient la nécessité de réaliser d'autres études en mobilisant d'autres méthodes possibles pour analyser le problème de la discrimination sur le marché québécois. Dans le cadre de notre étude, nous mobilisons la méthode statistique d'étude des écarts pour mesurer la discrimination entre les personnes nées au Québec ou au Canada et les immigrants internationaux d'une manière général.

\newpage

# MÉTHODOLOGIE

Afin de réaliser ce travail, une méthodologie en trois phases a été appliquée : collecte de données, analyse exploratoire, analyse économétrique. Nous présentons ci-dessous de manière détaillée chacune de ces étapes.

## Collecte des données

Les données ont été collectées sur le site de Statistique Canada, l'institution gouvernementale de référence en matière de production de données statistiques. Statistique Canada réalise mensuellement une Enquête sur la population active (EPA) et publie les données brutes collectées à chaque fin du mois. Cette enquête vise à informer sur la situation du marché de l'emploi à travers tous le Canada. A cet effet, les données publiées concernent plusieurs les provinces canadiennes. Nous nous intéresserons dans en premier lieu aux données sur le Québec. Par la suite, nous considérerons les données de trois autres provinces du Canada aux fins comparatives.

Dans le cadre de cette étude, nous avons utilisé les données publiées au mois d'avril 2022. Des informations supplémentaires concernant l'EPA ainsi que les données publiées sont accessibles en ligne[^2]. Pour accéder à la base de données brutes et au script R utilisés pour réaliser cette étude, lire les instructions à l'annexe. Dans le Tableau \@ref(tab:varDescrip) ci-dessous, nous présentons les variables constituées après la phase de traitement des données sur R.

[^2]: Enquêtes et programmes statistiques - Enquête sur la population active (EPA). [Consulter en ligne](https://www23.statcan.gc.ca/imdb/p2SV_f.pl?Function=getSurvey&Id=1389764)

```{r varDescrip}
tab1 <- descrip %>% flextable() %>% set_caption("Description des variables") %>% width(j = 2, width = 6)
tab1
```

## Analyse exploratoire

Afin de mieux visualiser les variables dans la base de données nous faisons une analyse exploratoire. Nous examinons les statistiques descriptives des variables et nous réalisons quelques représentations graphiques des données. Nous réalisons également une Analyse en composantes multiples (ACM) afin de détecter des liens potentiels entre les variables. Sur R, le modèle ACM est obtenu à partir de la commande : `MCA(dataframe, quali.sup, quanti.sup)` de la librairie `FactoMineR`.

## Analyse économétrique

Ce travail est articulé autour de deux principaux modèles économétriques. Un premier modèle de régression linéaire multiple (OLS) sert à vérifier l'existence d'une discrimination dans la rémunération salariale entre les immigrants et les natifs. L'analyse est approfondie par la méthode de décomposition d'Oaxaca-Blinder des inégalités salariaux observés entre les deux groupes. Le deuxième modèle estime la probabilité qu'un individu tombe en situation de chômage. Nous utilisons la méthode de régression logistique pour estimer les probabilités par Maximum de Vraissemblance. Les écarts de probabilités obtenues sont ensuite décomposés par la méthode Fairlie. Tous les calculs économétriques ont été réalisés sur R. Nous décrivons succinctement les modèles de régression et les méthodes de décompositions à travers les lignes qui suivent.

### Modélisation de la rémunération salariale

Le modèle de régression du salaire horaire est le suivant :

$Ln(SAL) = \hat{b}_{0} + \hat{b}_{1}YOUNG + \hat{b}_{2}WOMAN + \hat{b}_{3}MARRIED + \hat{b}_{4}EDUC. LEVEL + \hat{b}_{5}IMMIGRANT + \hat{b}_{6}SELF.EMP$ $+ \hat{b}_{7}PART. TIME + \hat {b}_{8}SYNDIC + \hat {b}_{9}LARGFIRM + \hat {b}_{10}OCCUP. SEC + \hat {b}_{11}YRS. TENURE + \epsilon$

La régression par la méthode OLS permet d'estimer les variations en pourcentage dans le salaire horaire suite à une modification dans les variables indépendantes. Sur R, la régression multilinéaire est obtenue à partir de la commande : `lm(formula, data)`.

### Décomposition des inégalités salariaux : méthode Oaxaca

La méthode Oaxaca-Blinder est la méthode la plus classique utilisée en économétrie pour décomposer les inégalités mesurées entre deux groupes pour une variable donnée [@insee2019; @hlavac2014]. Elle est facilement applicable lorsque la variable d'intérêt est continue comme dans le cas du salaire. Cette méthode décompose l'écart observé entre les moyennes mesurées dans chaque groupe en deux parties : une partie expliquée par les différences de caractéristiques entre les groupes et une partie inexpliquée. Dans notre cas actuel où la mesure porte sur l'écart de salaire entre les immigrants et les natifs, la partie inexpliquée de l'écart observé correspondra à une discrimination salariale pure en faveur d'un groupe et en défaveur d'un autre groupe. L'équation de la décomposition par la méthode Oaxaca est la suivante :

$\bar{Y}_{B}-\bar{Y}_{A} = \underbrace {\left [ \sum_{k=1}^{K} \left( \bar{X}_{Bk}-\bar{X}_{Ak} \right) \hat{\beta}_{Bk} \right ]}_{\Delta_{x}:\mbox{ explained}} + \underbrace {\left [ \left( \hat{\beta}_{B0} - \hat{\beta}_{A0} \right) + \sum_{k=1}^{K} \hat{X}_{Ak} \left( \hat{\beta}_{Bk} - \hat{\beta}_{Ak} \right) \right ]}_{\Delta_{x}:\mbox{ unexplained}}$

Où $\bar{Y}_{B}-\bar{Y}_{A}$ est la valeur de l'écart observé entre les moyennes des groupes B et A; les $\left ( \hat{\beta}_{g,k} \right )_{k=1\cdots K, g=A,B}$ sont les coefficients de valorisation des caractéristiques *k* dans chaque groupe *g*; $\left ( \bar{X}_{g,k} \right )_{k=1\cdots K, g=A,B}$ sont les moyennes mesurées des caractéristiques *k* dans chaque groupe *g*.

### Modélisation de la facilité d'accès à l'emploi

Le modèle de régression de la probabilité de chômage est le suivant :

$Ln\left( \frac{p \left( 1 \mid X \right)}{1 - p \left( 1 \mid X \right)} \right) = \hat{b}_{0} + \hat{b}_{1}YOUNG + \hat{b}_{2}WOMAN + \hat{b}_{3}MARRIED + \hat{b}_{4}EDUC. LEVEL + \hat{b}_{5}IMMIGRANT$

Où $p \left( 1 \mid X \right)$ désigne la probabilité d'être au chômage.

Cette régression mobilise une loi logistique pour estimer les variations dans la probabilité d'être au chômage. Sur R, la régression logistique est réalisée à l'aide de la commande : `glm (formula, data, family = binomial(link="logit"))`.

### Décomposition des écarts de probabilité de chômage : méthode Fairlie

La méthode Fairlie est une alternative à la méthode Oaxaca-Blinder pour décomposer un écart à la moyenne entre deux groupe, lorsque l'approximation linéaire pose problème ou lorsque les différences de caractéristiques observables sont très marquées entre les deux groupes (INSEE, 2019). Elle est adaptée pour la modélisation non linéaire de type probit ou logit. L'équation de la décomposition est la suivante :

$\bar{Y}_{B} - \bar{Y}_{A} = \underbrace {\frac{1}{N_{B}} \sum_{i \in B} Y_{i} - \frac{1}{N_{A}} \sum_{i \in A} \hat{P}_{B}(Y_{i} = 1 \mid X_{i})}_{\mbox{explained}} + \underbrace {\frac{1}{N_{A}} \sum_{i \in A} \hat{P}_{B}(Y_{i} = 1 \mid X_{i}) - \frac{1}{N_{A}} \sum_{i \in A} Y_{i}}_{\mbox{unexplained}}$

Avec $\bar{Y}_{B} - \bar{Y}_{A}$, l'écart observé entre les moyennes des groupes *B* et *A*; $N_{A}$ et $N_{B}$, les effectifs dans les deux groupes; $\hat{P}_{B}(Y_{i} = 1 \mid X_{i})$, les estimations de probabilités contrefactuelles pour chaque individu du groupe *A* (i-e, la probabilité que l'individu du groupe A soit au chômage si ses caractéristiques sont valorisées comme celles du groupe *B*). Le contrefactuel est fondé sur l'estimation du modèle probit ou logit.

\newpage

# RÉSULTATS

## Analyse exploratoire

### Description de l'échantillon

Le Tableau \@ref(tab:statdesc) à la page suivante présente la répartition de notre échantillon suivant les différentes variables de la base de données. Notre échantillon comprend 21063 individus dont 13% d'immigrants. Ce pourcentage est similaire à celui observé dans la population québécoise, soit 13.7% d'immigrants selon le dernier recensement de 2016 [@mifi2021]. Par ailleurs, il y a une majorité de répondants ayant le statut de salariés, alors que seulement 11% des participants ont rapporté être des travailleurs autonomes. La majorité des travailleurs sont à temps plein et ne sont pas protégés par un syndicat. Les jeunes de moins de 30ans et les personnes mariées sont minoritaires, alors que les répondants sont plus ou moins équitablement répartis entre les femmes et les hommes. Plus de 60% des répondants ont un niveau d'éducation moyen ou élevé contre 33% de personnes à faible niveau d'éducation. La plupart des travailleurs sont répartis dans les ventes et services (SEC6) comparativement aux autres catégories professionnelles. En moyenne, les salariés gagnaient 30.17 \$/h et occupaient leur emploi actuel depuis 7.85 années. Toutefois, ces valeurs moyennes ne représentent pas bien l'échantillon car leurs distributions sont très dispersées.

```{r statdesc}
tab2 <- knitr::kables(list(kable(stat1) %>% add_footnote("(prop_n) calculée dans la population \ndes chômeurs (N = 460)", notation = "symbol") %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = paste0("Statistique descriptive ", "(N = ", obs, ")")) %>% kable_styling()
tab2
```

### Analyse en composantes multiples

Nous testons l'existence d'interrelation entre les variables de notre base de données par une analyse factorielle en composante multiples (ACM). Nous utilisons pour cela la librairie FactoMineR sur R. Les variables d'identité individuelle (genre, âge, statut matrimonial, éducation et statut d'immigrant) sont retenues comme variables fondamentales constituant les dimensions du repère alors que les autres variables catégorielles sont identifiées comme variables qualitatives supplémentaires. Nous représentons à la Figure \@ref(fig:acm) les coordonnées respectives des variables supplémentaires et des variables fondamentales les mieux projetées sur les deux premières dimensions du repère.

Nous pouvons établir l'existence d'une relation potentielle entre les variables qui se rapprochent dans une même partie du cadrant. Nous voyons ainsi à la Figure \@ref(fig:acm)-B que les travailleurs à temps partiels se retrouvent le plus souvent dans les professions des ventes et services, alors que ceux à temps plein sont souvent dans le secteur « Affaires, finance et administration » et sont couverts par un syndicat. La Figure \@ref(fig:acm)-A montre des relations moins fortes entre les variables fondamentales. Nous voyons plus certainement que les natifs canadiens sont le plus souvent de sexe masculin. Dans une moindre mesure, nous pouvons affirmer aussi qu'un natif a plus probablement un niveau d'éducation moyen, alors qu'il est plus facile de retrouver un immigrant avec un niveau élevé d'éducation. Par ailleur les femmes ont tendance à avoir un meilleur niveau d'éducation que les hommes.

```{r acm, fig.show="hold", out.width="50%", fig.align='center', fig.cap = "Représentation des variables dans le plan ACM"}
p0
p1
```

### Analyse comparative : immigrants vs natifs

L'analyse comparative entre immigrants et natifs peut être initiée par un examen des distributions de nos variables d'intérêt dans chaque sous-échantillon. En examinant les Figure 3 ci-dessous, nous voyons que les immigrants sont relativement plus concentrés dans la catégorie des bas salaires (\<30 \$/h) notamment dans la tranche des salaires allant de 14 à 29 \$h. Parallèlement, les natifs sont en proportion relativement plus élevée dans la catégorie des hauts salaires (\>30 \$/h) et en particulier dans la tranche des 30 à 52 \$/h. Nous voyons également que les distributions sont centrées à gauche, ce qui veut dire que la majorité des individus gagnent un salaire inférieur à la moyenne de leur groupe.

```{r acomp1, fig.show="hold", out.width="50%", fig.align='center', fig.cap = "Distribution du salaire horaire immigrants vs natifs (boîtes à moustaches et courbes de densité"}
p2
p3
```

Nous affichons ci-dessous le résultat d'un test de moyenne réalisé sur les salaires des deux groupes (immigrants vs natifs). Nous observons que le salaire moyen dans des immigrants est légèrement inférieur celui des natifs (`r mean_im` vs `r mean_nat`). L'écart observé est statistiquement significatif ($\alpha < 0.05$), mais il peut être dû d'autres facteurs non contrôlés. A ce stade, nous ne pouvons donc pas affirmer avec certitude qu'un immigrant gagne moins qu'un natif.

```{r ttestSal}
tmoy
```

La figure \@ref(fig:acomp2) ci-dessous compare les proportions de natifs et d'immigrants au chômage. D'une manière générale, on remarque que le taux de chômage est très bas au Québec. Il y a donc globalement une bonne insertion de la population sur le marché de l'emploi. Cependant, on constate que le taux de chômage est plus élevé chez les immigrants que chez les natifs (`r rc_im` vs `r rc_nat`). En outre, les immigrants en situation de chômage longue durée sont aussi en proportion relativement plus élevée comparés au natifs (`r rlc_im` vs `r rlc_nat`). Les résultats des tests de $\chi^2$ signalent que les proportions observées sont bien différentes entre les groupes. Toutefois, cela ne nous permet pas d'affirmer qu'un immigrant peut plus facilement se retrouver au chômage ou au chômage longue durée sans contrôler l'effet des autres variables qui peuvent influencer la probabilité qu'un individu se trouve dans de telles situations.

```{r acomp2, out.width="50%", fig.align='center', fig.cap = "Comparaison des taux de chômage observés (immigrants vs natifs)"}
p4
```

## Mesure de la discrimination salariale

Nous allons ici mesurer l'influence du statut d'immigrant sur la rémunération salariale des individus en tenant compte de l'effet possible d'autres facteurs. Dans un premier temps nous présentons les résultats de l'estimation du modèle de régression multiple avec comme variable dépendante le logarithme des salaires. L'impact des variables sur le salaire horaire est mesuré en pourcentage. Nous appliquons ensuite la méthode Oaxaca afin de décomposer les écarts de salaires (mesurés en dollars canadiens) entre les groupes des immigrants et des natifs.

### Estimations par régression linéaire

Les Figures \@ref(fig:olsGraph1), \@ref(fig:olsGraph2) et \@ref(fig:olsGraph3) résument les résultats des estimations faites par régression linéaire sur le logarithme du salaire horaire. Les données chiffrées peuvent être consultés en annexe (Tableau \@ref(tab:olsTab)). L'effet de chaque variable sur le salaire est calculé en pourcentage. Avec un $R^2$ ajusté de plus de 50%, le pouvoir explicatif de ce modèle est assez intéressant. A l'exception du statut de marié, tous les coefficients du modèle sont significatifs au seuil $\alpha=0.05$. Les résultats des estimations montrent qu'**un immigrant québécois gagne 10% de moins qu'un natif toute chose étant égale par ailleurs** (Figure \@ref(fig:olsGraph1)). Il y a donc discrimination salariale en faveur des natifs. Le modèle indique par ailleurs que l'âge jeune (-30 ans) et le travail à temps partiel ont un effet négatif beaucoup plus fort sur le niveau de salaire perçu par les individus (resp. -15% et -12%). Le genre (femme) affecte aussi négativement le salaire mais à un niveau moindre que le statut d'immigrant. Les autres variables (années d'expérience, appartenance à un syndicat, grande entreprise) influencent positivement le salaire.

Les résultats montrent que le niveau d'éducation a une influence positive sur le taux de salaire horaire au Québec (Figure \@ref(fig:olsGraph2)). Les personnes plus éduquées gagnent entre 8% et 30% de plus que celle avec une éducation secondaire ou inférieure. On remarque aussi que d'importantes variations dans les salaires selon les secteurs d'activités. Le secteur des ventes et services récolte les salaires les plus faibles, alors que les professionnels en Gestion gagnent un salaire 63% plus élevé (Figure \@ref(fig:olsGraph3)).

Considérant l'influence des autres variables sur le salaire et tenant compte des inégalités de répartition des échantillons d'immigrants et de natifs dans chacune de ces variables, nous supposons que la discrimination salariale (immigrants vs natifs) est due en partie aux différences de caractéristiques entre les deux groupes. Nous approfondissont cet aspect d'analyse à la section \@ref(décomposition-de-lécart-de-salaire-immigrants-vs-natifs).

```{r olsGraph1, fig.show="hold", out.width="60%", fig.align='center', fig.cap="Impact des caractéristiques individuelles sur le salaire horaire"}
p5
```

\n

```{r olsGraph2, fig.show="hold", out.width="60%", fig.align='center', fig.cap="Impact de l'éducation sur le salaire horaire (réf. Niveau d’éducation secondaire ou inférieur"}
p6
```

\n

```{r olsGraph3, fig.show="hold", out.width="60%", fig.align='center', fig.cap="Impact du secteur d'activité sur le salaire horaire (réf. Secteur des ventes et services"}
p7
```

### Décomposition de l'écart de salaire (natifs vs immigrants)

Le résultat de la décomposition de l'écart salarial entre les natifs (groupe A) et les immigrants (groupe B) est présenté dans la Figure \@ref(fig:ecartSalgraph) et détaillé au Tableau \@ref(tab:ecartSalTab). On constate que une grande différence entre l'écart attendu *(expected)* par le modèle et l'écart observé entre les deux groupes *(observed)*. L'écart inexpliqué *(unexplained)* est la différence entre l'écart observé et l'écart attendu.

La première colonne du Tableau \@ref(tab:ecartSalTab) donne la répartition des deux groupes dans l'échantillon alors que les moyennes de salaire associées à chaque groupe figurent dans la deuxième colonne. Nous observons une différence de salaire horaire de 0,8 \$ en faveur des natifs (\$y.diff). Cet écart peut être décomposé suivant les données inscrites dans les deux dernières colonnes du tableau : -2,65\$ peuvent être expliqués par le modèle dont 63% (-1,67\$) sont dues à la stricte dotation en caractéristiques différentes entre les groupes et 37% (-0,99\$) aux interactions entre les caractéristiques et leur valorisation sur le marché; 3,48\$ d'écart restent donc inexpliqués par le modèle. C'est écart inexpliqué peut être considéré comme une discrimination salariale pure en faveur des natifs et à l'encontre des immigrants. En prenant les natifs comme situation de référence, l'analyse des résultats de la décomposition indique que compte tenu des différences de caractéristiques entre les deux groupes et des interactions, on devrait en principe observer un salaire moyen de 32,94\$/h chez les immigrants ce qui correspondrait à un écart salarial de 2,65\$ en leur faveur. Or le salaire moyen observé chez les immigrant est 29,46\$/h soit un écart de 0,83\$ en faveur des natifs. Cela implique donc une discrimination de 3,48\$ à l'encontre des immigrants.

```{r ecartSalgraph, out.width="60%", fig.align='center', fig.cap="Décomposition de l'écart salarial entre natifs et immigrants"}
p8
```

\n

```{r ecartSalTab}
#Oaxaca decomposition results - table

tab4 <- oaxacaResume %>% flextable() %>% set_caption("Décomposition de l'écart salarial entre natifs (A) et immigrants (B)")
tab4
#oaxacaResume %>% flextable() %>% set_caption("Wage decomposition between Canadian born (A) and Immigrant (B)") #for fitting PDF doc
```

Nous analysons de manière détaillée la portion de l'écart salarial expliqué par les différences de caractéristiques entre natifs et immigrants (Figure \@ref(fig:ecartSalEndow). Nous voyons que le niveau d'éducation élevé (EDUC.LEVEL2) et la présence au secteur des Sciences naturelles et appliquées (OCCUP.SEC3) sont les deux caractéristiques qui jouent le plus en faveur des immigrants et en défaveur des natifs. Ces caractéristiques représentent respectivement 88% et 54% de l'écart expliqué par les différences dans les dotations individuelles. Ces résultats concordent avec l'analyse descriptive de notre échantillon des salariés. On observe en effet que comparativement aux natifs, il y a une plus grande proportion d'immigrants ayant un niveau d'éducation élevé ou supérieur au baccalauréat[^3] (49,4% vs 24,6%) et concentrés dans les professions des Sciences naturelles et appliquées (14,7% vs 8,8%). Or ces critères sont valorisés positivement sur le marché du travail québécois (voir Figures \@ref(fig:olsGraph2) et \@ref(fig:olsGraph3)). Cela explique donc que le fait que les immigrants sont avantagés par ces caractéristiques. Par ailleurs, les immigrants sont favorisés par le fait d'être moins jeunes, de travailler davantage dans le secteur de la santé (OCCUP.SEC4), de travailler moins à temps partiel et plus dans les grandes entreprises. De leur côté, les non immigrants prennent de l'avantage à cause de leur meilleure répartition dans certaines catégories professionnelles (la gestion, les arts et les métiers du transport) ainsi que leur plus grande ancienneté dans l'emploi.

[^3]: Au Québec, le baccalauréat désigne le premier cycle universitaire.

```{r ecartSalEndow, out.width="70%", fig.align='center', fig.cap="Impact des différences de caractéristiques entre natifs et immigrants sur l'écart salarial"}
p9
```

Avec la prise en compte des interactions, les contributions des variables à la formation du total de l'écart expliqué par le modèle changent légèrement. Certaines variables comme le statut de marié jouent en faveur des immigrants alors que d'autres, comme le niveau d'éducation moyen, avantagent les natifs (Figure \@ref(fig:ecartSalExpl)).

```{r ecartSalExpl,  out.width="70%", fig.align='center', fig.cap="Impact des interactions ajoutées aux différences de caractéristiques sur l'écart salarial (natifs vs immigrants)"}
p10
```

## Mesure de la discrimination dans l'accès à l'emploi

Nous avons vu que les immigrants sont défavorisés sur le marché du travail québécois ence qui a trait à la rémunération salariale. Nous nous interrogeons à présent sur leur situation en termes d'accès à l'emploi. Est-ce qu'un immigrant arrive à trouver un emploi aussi facilement qu'un natif ? Les résultats des test de chi2 réalisés à l'étape de l'analyse exploratoire (section \@ref(analyse-exploratoire) ) nous suggéraient que non. Mais nous devons pouvoir étayer les évidences à partir d'un modèle économétrique. Nous allons ici contrôler l'effet d'autres facteurs afin de pouvoir établir l'influence du statut d'immigrant sur la probabilité d'être au chômage. Ci-dessous, nous présentons les résultats du modèle de régression de la probabilité de chômage. Nous utilisons ensuite la méthode de Fairlie pour décomposer l'écart observé entre les deux groupes.

### Estimations par régression logistique

La Figure \@ref(fig:logitGraph) présente les résultats de la régression logistique de la probabilité qu'un individu en quête d'emploi sur le marché québécois se retrouve au chômage. Les variables âge, genre, statut matrimonial, éducation, statut d'immigrant et statut de travailleur autonome ont été retenues pour la régression. Les données chiffrées ainsi que les Odds ratio calculés sont présentés au Tableau \@ref(tab:logitTab). La variable catégorie professionnelle a été exclue dans ce modèle par manque de données.

Il en ressort que le statut d'immigrant revêt une influence significative et positive sur la probabilité d'être au chômage. L'Odds ratio calculé indique qu'un immigrant a près de 1,5 fois plus de chance de se retrouver au chômage comparativement à un natif (Tableau \@ref(tab:logitTab)). Par ailleurs, le statut de travailleur autonome, le niveau d'éducation, le genre (femme) et l'âge (significatif au seuil de 10%), ont aussi un impact sur la probabilité de se retrouver au chômage.

Les jeunes de moins de 30 ans ont 31% plus de chance d'être chômeurs. Cela pourrait s'expliquer par le manque d'expérience des jeunes sur le marché du travail. En ce qui a trait au niveau d'éducation, plus il est élevé, moins le travailleur a la chance de se retrouver au chômage. Comparativement aux personnes à faible niveau d'éducation, la probabilité de d'être au chômage est réduite de 31% pour les détenteurs d'un diplôme d'études post secondaire inférieures au baccalauréat et de 59% pour ceux ayant un baccalauréat ou plus (Tableau \@ref(tab:logitTab)). Ces résultats sont en accord avec la théorie du capital humain selon laquelle les individus constituent une ressource rare lorsqu'ils investissent dans leur formation [@vignolles2012]. Ils peuvent par conséquent accéder plus facilement à l'emploi.

```{r logitGraph, out.width="60%", fig.align='center', fig.cap="Influence des caractéristiques individuelles sur la probabilité d'être au chômage"}
p11
```

\n

```{r logitTab}
#Logistic Regression of the unemployment - table

# Tableau de l'ensemble des résultats de la régression
tab5 <- tot2[,] %>% flextable() %>% set_caption("Influence des caractéristiques individuelles sur le risque d'être au chômage") %>% colformat_double(digits = 4) %>% flextable::footnote(i=1, j=6, ref_symbols = "a", part = "header", value = as_paragraph("(***) : p-val. < 0.001 ; (**) : p-val. < 0.01; (*) : p-val. < 0.05; (.) : p-val. < 0.1"))
tab5

#knitr::kable(tot2[,], caption = "Influence des caractéristiques individuelles sur le risque d'être au #chômage", "simple")
#tot2 %>% regulartable() %>% autofit() %>% set_caption("Impact des variables sur la probabilité d'être au chômage") #for fitting PDF doc
```

### Décomposition de l'écart de probabilité de chômage (natifs vs immigrants)

Tout d'abord nous vérifions les différences de caractéristiques entre les deux groupes (Tableau \@ref(tab:fairlieTab)). On remarque que 3.34% de notre population d'immigrants sont chômeurs versus 2.01% de chômeurs dans la population des natifs. Il y a donc un écart observé de -1.33% entre les deux groupes. D'autres caractéristiques différencient les immigrants et les natifs. Il y a une plus grande proportion de femmes, de mariés, de personnes ayant un niveau d'éducation élevée et de personnes ayant le statut de travailleur autonome. Du côté des natifs, on observe une plus grande proportion de jeunes et de personnes à éducation faible et moyenne par rapport aux immigrants.

```{r fairlieTab}
#Différences de caractéristiques entre natifs et immigrants

tab6 <- tot3[,] %>% flextable() %>% set_caption("Différences de caractéristiques entre natifs (A) et immigrants (B)") %>% colformat_double(digits = 4)
tab6

#tab6 <- knitr::kable(tot3[-1,], caption = "Différences de caractéristiques entre natifs (A) et immigrants #(B)", "simple")
#tot3[-1,] %>% regulartable() %>% autofit() %>% set_caption("Différences de caractéristiques entre natifs (A) et immigrants (B)") #for fitting PDF doc
```

Nous allons à présent décomposer l'écart de probabilité de chômage observé entre les immigrants et les natifs. Dans le cas-ci où l'approximation linéaire s'avère problématique, la décomposition de l'écart entre deux groupes par la méthode d'Oaxaca-Blinder n'est pas appropriée. La méthode Fairlie adaptée la modélisation non linéaire de type probit ou logit permet de contourner ce problème [@insee2019]. Nous utilisons ainsi cette méthode pour décomposer l'écart observé dans la probabilité d'être au chômage. Le résultat de la décomposition est présenté à la Figure \@ref(fig:ecartChomGraph) au Tableau \@ref(tab:ecartChomTab). On remarque un écart inexpliqué de 0.7% de probabilité de chômage en défaveur des immigrants. En effet, si l'on prend la probabilité de chômage d'un natif (`r prop.A.pc`) comme référence, on devrait observer un taux de chômage de `r prop.cB.pc` chez les immigrants si leurs caractéristiques étaient valorisées comme les natifs. Or le taux chômage observé chez les immigrants est `r prop.B.pc`. Les immigrants sont donc également discriminés sur le marché du travail en ce qui a trait à l'accès à l'emploi.

```{r ecartChomGraph, out.width="60%", fig.align='center', fig.cap="Décomposition de l'écart de probabilité de chômage entre natifs et immigrants"}
p12
```

\n

```{r ecartChomTab}
#Decompose the unemployment rate gap betwenn immigrants and canadian born citizens - table1

tab7 <- tot4 %>% flextable() %>% set_caption("Décomposition de l'écart de probabilité de chômage entre natifs et immigrants") %>% colformat_double(digits = 4)
tab7

#tab7 <- knitr::kable(tot4, caption = "Décomposition de l'écart de probabilité de chômage entre natifs et #immigrants",
      #caption = "The unemployment rate gap: Canadian born (A) vs Immigrant (B)", 
      #"simple")
#tot4 %>% flextable() %>% set_caption("The unemployment rate gap: Canadian born (A) vs Immigrant (B)") #for fitting PDF

```

Contrairement à la méthode d'Oaxaca-Blinder, la méthode Fairlie ne nous permet pas de ventiler l'écart expliqué suivant la contribution des variables de caractéristiques. Nous pouvons néanmoins approfondir l'analyse sur la base des coefficients de valorisation des caractéristiques dans le groupe des natifs (Tableau \@ref(tab:ecartChomTab2)). Nous voyons que les personnes de niveaux d'éducation moyenne et élevé sont plus rarement en situation de chômage. Le niveau d'éducation moyen joue en faveur des natifs qui sont en plus grande proportion dans cette catégorie comparés aux immigrants. A l'inverse, le niveau d'éducation élevé joue en faveur des immigrants. Le statut de travailleur autonome ainsi que le genre (femme) jouent également en faveur des immigrants puisqu'ils sont répartis en plus grande proportion dans ces catégories et que ces dernières font diminuer le risque d'être au chômage.

```{r ecartChomTab2}
tot2_plus <- tot2[-6,] %>% add_row(variable="EDUC.LEVEL_0", .after = 3)
tot5 <- cbind(tot3[c(2:8),], estim_coef=tot2_plus$estim_coef, 
              sign=tot2_plus$sign)
#Decompose the unemployment rate gap between immigrants and canadian born citizens - table2

tab8 <- tot5[,] %>% flextable() %>% set_caption("Influence des caractéristiques individuelles (natifs(A) vs immigrants(B)) sur les probabilités de chômage") %>% colformat_double(digits = 4) %>% flextable::footnote(i=1, j=6, ref_symbols = "a", part = "header", value = as_paragraph("(***) : p-val. < 0.001 ; (**) : p-val. < 0.01; (.) : p-val. < 0.1"))
tab8

#tab8 <- kable(tot5[,], caption = "Influence des caractéristiques individuelles (natifs(A) vs immigrants(B)) #sur les probabilités de chômage", "simple")
#tot5 %>% regulartable() %>% autofit() %>% set_caption("Influence des caractéristiques individuelles #(natifs(A) vs immigrants(B)) sur les probabilités de chômage") #for fitting PDF doc
```

### Comparaison entre les provinces

Nous avons vu que les immigrants au Québec sont victimes de discrimination tant au niveau de la rémunération salariale que dans l'accès à l'emploi. Mais pour mieux apprécier la situation de ces immigrants, il est intéressant de comparer le Québec à d'autres province canadiennes. Le Canada compte 13 provinces dont cinq principales en termes de territoire et de population : le Québec (QC), l'Ontario (ON), la Colombie-Britannique (BC), le Manitoba (MB), et l'Alberta (AB). Ce sont également les provinces les plus fréquentées par les immigrants.

Nous comparons la situation des immigrants dans les principales provinces du Canada, à l'exception de la province d'Alberta pour laquelle les données sont manquantes dans notre base de données. Pour chaque province, nous réalisons la décomposition de l'écart salarial et de l'écart de probabilité de chômage entre les natifs et les immigrants. Nous utilisons ensuite les parties inexpliquées des écarts comme coordonnées de chaque province projetée sur le plan d'un repère cartésien (Figure \@ref(fig:regOaxacaAllGraph). Les données chiffrées peuvent être consultées au Tableau \@ref(tab:regOaxacaAllTab).

Comme nous pouvons le constater, les performances relatives des provinces varient suivant le critère considéré (accès à l'emploi ou rémunération salariale). Le Manitoba s'en sort très bien pour ce qui est de l'accès à l'emploi avec un écart de probabilité de chômage quasi nul entre immigrants et natifs. Cette province affiche toutefois la plus forte discrimination salariale (4.89\$/h à l'encontre des immigrants). C'est en Ontario que les immigrants sont plus justement rémunérés même s'ils sont encore discriminés (2.71\$/h de moins que les natifs). Le Québec affiche la moins bonne performance quant à l'accès à l'emploi mais fait mieux que le Manitoba et la Colombie-Britannique en ce qui a trait à la rémunération salariale. Pour s'améliorer, la « Belle Province » peut regarder vers le Manitoba qui n'affiche aucune discrimination contre les immigrants au niveau de l'accès à l'emploi, et l'Ontario où la discrimination salariale est beaucoup plus faible.

```{r regOaxacaAllGraph, out.width="60%", fig.align='center', fig.cap="Discrimination entre natifs et immigrants sur le marché du travail au Canada : comparaison entre provinces"}
p13
```

\n

```{r regOaxacaAllTab}
#Salary and Employment access discrimination - Comparing different canadian provinces - table

tab9 <- tab_all %>% flextable() %>% set_caption("Discrimination entre natifs et immigrants sur le marché du travail au Canada : comparaison entre provinces") %>% colformat_double(digit = 4)
tab9

#tab9 <- knitr::kable(tab_all, caption = "Discrimination entre natifs et immigrants sur le marché du travail #au Canada : comparaison entre provinces", "simple")
#tab_all %>% regulartable() %>% autofit() %>% set_caption("Discrimination entre natifs et immigrants sur le marché du travail au Canada : comparaison entre provinces") #for fitting PDF doc
```

\newpage

# CONCLUSION

Ce travail a permis de mettre en lumière l'existence d'une discrimination à l'encontre des immigrants au Québec tant au niveau de l'accès à l'emploi que de la rémunération salariale. Les immigrants sont donc doublement défavorisés sur le marché du travail.

Au niveau de l'accès à l'emploi, la situation est plus compliquée pour les immigrants comparés aux natifs. En effet, les immigrants ont 1.5 fois plus de chance de se retrouver au chômage. Par ailleurs, la proportion de chômeur longue durée est plus élevée chez les immigrants chômeurs que chez les natifs chômeurs. Les probabilités de chômage observées dans le groupe des immigrants et des natifs sont respectivement `r prop.B.pc` et `r prop.A.pc`. Or la probabilité d'être au chômage chez les immigrants devait être de `r prop.cB.pc` si leurs caractéristiques étaient valorisées comme celles des natifs. Ce surplus de probabilité de chômage de 1,8% chez les immigrants ne s'explique donc que par une discrimination purement négative à l'encontre de ces derniers.

Au niveau de la rémunération salariale, un immigrant gagne 10% de moins par rapport à un natif à compétence égale. Il s'agit là d'un acte de discrimination. En moyenne, un immigrant gagne 29,46 \$/h contre 30,29 \$/h pour un natif, ce qui correspond à un écart salarial observé de 0,83 \$/h entre les deux groupes. En prenant les natifs comme situation de référence pour la valorisation des caractéristiques, nous avons vu que le salaire moyen des immigrants aurait dû être de 32,9\$/h compte tenu des caractéristiques de leur groupe versus celles des natifs. Ce surplus contrefactuel de 2,65\$/h s'expliquerait par les avantages que les immigrants retireraient notamment de leur plus grande proportion d'individus ayant un niveau d'éducation élevé et de travailleurs dans le secteur des Sciences naturelles et appliquées. Il y a donc un écart inexpliqué de 3,48\$ entre le salaire horaire moyen que les immigrants auraient dû percevoir et ce qu'ils perçoivent dans la réalité.

En comparant le Québec avec d'autres provinces du Canada (Ontario, Comlombie-Britannique et Manitoba), nous avons remarqué que le Québec affiche la pire performance quant à l'accès à l'emploi mais s'en sort mieux que le Manitoba et la Colombie-Britannique en ce qui a trait à la rémunération salariale.

Dans la vision d'un monde équitable et juste, les résultats de ce travail appellent à un renforcement des politiques d'insertion professionnelle et de lutte contre les discriminations envers les immigrants au Québec. Pour s'améliorer, la « Belle Province » aura l'intérêt de regarder vers le Manitoba qui n'affiche aucune discrimination niveau de l'accès à l'emploi ainsi que l'Ontario où la discrimination salariale est la plus faible.

# BIBLIOGRAPHIE

::: {#refs}
:::

\newpage

# ANNEXE {.unnumbered}

## Compléments de résultats {.unnumbered}

```{r olsTab}
#OLS regression of the salary - estimated parameters - table

tab3 <- tot[,] %>% flextable() %>% set_caption("Résultats de la regression OLS du logarithme du salaire horaire") %>% colformat_double(digits = 4) %>% flextable::footnote(i=1, j=6, ref_symbols = "a", part = "header", value = as_paragraph("(*) : p-val. < 0.05"))
tab3
#tab3 <- knitr::kable(tot[,], caption = "Impact des variables sur le salaire horaire", "simple")
#tot <- tot %>% mutate(estim_coef=round(estim_coef,3), inf=round(inf,3), sup=round(sup,3),
#               p_value=round(p_value,4))
#tot %>% regulartable() %>% autofit() %>% set_caption("Impact des variables sur le salaire horaire") #for fitting PDF doc
#knitr::kable(tot, caption = 'Impact des variables sur le salaire horaire', booktabs = TRUE, valign = 't')   #for fitting PDF doc
```

## Base de données et codes sources {.unnumbered}

Afin d'assurer la reproductibilité de cette recherche, je rends disponible sur mon compte Github la base de données nommées pub0422.csv accompagnée du fichier script discrim_script.Rmd. Vous pouvez également accéder à la version web du script en téléchargeant le fichier discrim_script.html. Un dictionnaire détaillé qui définit les variables présentes dans la base se trouve dans le fichier dico.csv. Pour accéder aux ressources, utilisez les liens ci-dessous :

[Accéder à la base de données](https://github.com/frantz93/discrimination/tree/main/base "Base de données")

[Accéder aux codes sources](https://github.com/frantz93/discrimination/tree/main/script "Script")
