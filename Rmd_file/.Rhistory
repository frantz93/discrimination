#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), kable(stat2) %>% kable_styling()))
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data_frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data_frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data_frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL), mean(YRS.TENURE)), ecart-type = c(sd(SAL), sd(YRS.TENURE)))
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL), mean(YRS.TENURE)), ecart-type = c(sd(SAL), sd(YRS.TENURE)))
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL), mean(YRS.TENURE)), ecart_type = c(sd(SAL), sd(YRS.TENURE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), kable(stat2) %>% kable_styling())) %>% kable_styling()
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL), mean(YRS.TENURE)), ecart_type = c(sd(SAL), sd(YRS.TENURE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), kable(stat2) %>% kable_styling())) %>% kable_styling()
kable(stat3) %>% kable_styling()
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat3) %>% kable_styling(), kable(stat2) %>% kable_styling()))) %>% kable_styling()
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling()))) %>% kable_styling() %>%
set_caption("Statistique descriptive")
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling() %>%
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
#N <- baseQC %>% summarise(total =n()) %>% .$total
#baseQC %>% select(-c(4,13:16)) %>% group_by(YOUNG) %>% summarise(n = n(), prop_n = n()/N)
#data.frame(unclass(summary(baseQC, maxsum = 12)), check.names = FALSE, stringsAsFactors = FALSE)
#table
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling()
#summary(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling()
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
n(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
n(baseQC$YOUNG)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
obs(baseQC)
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
nrow(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling()
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
ncol(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling()
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
options(digits = 8/2, scipen = 00)
library(tidyverse)
library(knitr)
library(flextable)
library(kableExtra)
library(FactoMineR)
library(ggplot2)
library(ggthemes)
library(scales)
library(gridExtra)
set_flextable_defaults(fonts_ignore = TRUE)
# Lecture et visualisation de la base de donnees
load("../base.RData")
# Creation et formattage des variables
attach(base)
base$YOUNG <- factor(if_else(AGE < 3, 1, 0))
base$WOMAN <- factor(if_else(SEX == 1, 0, 1))
base$MARRIED <- factor(if_else(MARSTAT == 1, 1, 0))
base$EDUC.LEVEL <- factor(if_else(EDUC < 3, 0, if_else(EDUC < 5, 1, 2)))
base$IMMIGRANT <- factor(if_else(IMMIG != 3, 1, 0))
base$ISPAID <- factor(PAID)
base$SELF.EMP <- factor(if_else(CATWORK == 1, 0, 1))
base$PART.TIME <- factor(if_else(WTIME == 2, 1, 0))
base$SYNDIC <- factor(if_else(UNION != 3, 1, 0))
base$LARGFIRM <- factor(if_else(FIRMSIZE == 4, 1, 0))
base$ISUNEMP <- factor(UNEMP)
base$LONG.UNEMP <- factor(if_else(DURUNEMP >= 52, 1, 0))
base$OCCUP.SEC <- factor(OCCUP)
base$OCCUP.SEC <- factor(OCCUP, levels = c(7, 1, 2, 3, 4, 5, 6, 8, 9, 10))
base$SAL <- HRLYEARN/100
base$YRS.TENURE <- base$TENURE/12
base$PROVINCE <- factor(PROV, labels = c("Terre-Neuve-et-Labrador", "Île-du-Prince-Édouard", "Nouvelle-Écosse", "Nouveau-Brunswick",
"Québec", "Ontario", "Manitoba", "Saskatchewan", "Alberta", "Colombie-Britannique"))
base$LN.SAL <- log(base$SAL)
descrip <- data.frame(Variable=names(select(base,c(18:32))),
Description=c("Catégorie d’âge de l’individu : (1) si âgé de moins de 30 ans ; (0) sinon.",
"Genre femme : (1) s’il s’agit d’une femme ; (0) pour les hommes.",
"Statut matrimonial : (1) si marié ; (0) sinon.",
paste0("Niveau d’éducation : (0) faible [études secondaires ou moins] ; (1) moyen [études ",
"post-secondaires inférieures au baccalauréat] ; (2) élevé [diplôme de baccalauréat ",
"ou plus]"),
"Statut d’immigrant : (1) si la personne est immigrante ; (0) si la personne est née au Canada.",
"Statut de salarié : (1) si la personne perçoit un salaire ; (0) sinon.",
paste0("Statut de travailleur autonome : (1) si le répondant est travailleur autonome ; ",
"(0) s’il s’agit d’un employé."),
"Temps de travail : (1) temps partiel ; (0) temps plein.",
paste0("(1) Si la personne est membre d’un syndicat ou couverte par une convention collective ",
"négociée par un syndicat ; (0) sinon."),
paste0("Taille de l’entreprise employeuse : (1) pour les grandes firmes de plus de 500 employés",
"; (0) pour les plus petites entreprises."),
"(1) Si la personne est au chômage ; (0) sinon.",
"(1) Pour les personnes en recherche d’emploi depuis au moins 12 mois chômage long ; (0) sinon.",
paste0("Catégories professionnelles selon le système de classification nationale : (1) Gestion ",
"(2) Affaires, finance et administration (3) Sciences naturelles et appliquées et ",
"domaines apparentés (4) Secteur de la santé (5) Enseignement, droit et services ",
"sociaux, communautaires et gouvernementaux (6) Arts, culture, sports et loisirs ",
"(7) Vente et services (8) Métiers, transport, machinerie et domaines apparentés ",
"(9) Ressources naturelles, agriculture et production connexe ",
"(10) Fabrication et services d'utilité publique"),
"Salaire horaire habituel (en dollar canadien)",
"Durée de l'emploi avec l'employeur actuel (en années)"))
kable(descrip, caption = "Description des variables", "simple")
#descrip %>% regulartable() %>% autofit() %>% width(j=~Variable, width = 1) %>% width(j=~Description, width = 5.4) %>% set_caption("Description des variables") #for fitting PDF doc
baseQC.paid <- baseQC %>% filter(ISPAID == 1)  #Filtrage des donnees des salariés au Quebec
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
options(digits = 8/2, scipen = 00)
library(tidyverse)
library(knitr)
library(flextable)
library(kableExtra)
library(FactoMineR)
library(ggplot2)
library(ggthemes)
library(scales)
library(gridExtra)
set_flextable_defaults(fonts_ignore = TRUE)
# Lecture et visualisation de la base de donnees
load("../base.RData")
# Creation et formattage des variables
attach(base)
base$YOUNG <- factor(if_else(AGE < 3, 1, 0))
base$WOMAN <- factor(if_else(SEX == 1, 0, 1))
base$MARRIED <- factor(if_else(MARSTAT == 1, 1, 0))
base$EDUC.LEVEL <- factor(if_else(EDUC < 3, 0, if_else(EDUC < 5, 1, 2)))
base$IMMIGRANT <- factor(if_else(IMMIG != 3, 1, 0))
base$ISPAID <- factor(PAID)
base$SELF.EMP <- factor(if_else(CATWORK == 1, 0, 1))
base$PART.TIME <- factor(if_else(WTIME == 2, 1, 0))
base$SYNDIC <- factor(if_else(UNION != 3, 1, 0))
base$LARGFIRM <- factor(if_else(FIRMSIZE == 4, 1, 0))
base$ISUNEMP <- factor(UNEMP)
base$LONG.UNEMP <- factor(if_else(DURUNEMP >= 52, 1, 0))
base$OCCUP.SEC <- factor(OCCUP)
base$OCCUP.SEC <- factor(OCCUP, levels = c(7, 1, 2, 3, 4, 5, 6, 8, 9, 10))
base$SAL <- HRLYEARN/100
base$YRS.TENURE <- base$TENURE/12
base$PROVINCE <- factor(PROV, labels = c("Terre-Neuve-et-Labrador", "Île-du-Prince-Édouard", "Nouvelle-Écosse", "Nouveau-Brunswick",
"Québec", "Ontario", "Manitoba", "Saskatchewan", "Alberta", "Colombie-Britannique"))
base$LN.SAL <- log(base$SAL)
descrip <- data.frame(Variable=names(select(base,c(18:32))),
Description=c("Catégorie d’âge de l’individu : (1) si âgé de moins de 30 ans ; (0) sinon.",
"Genre femme : (1) s’il s’agit d’une femme ; (0) pour les hommes.",
"Statut matrimonial : (1) si marié ; (0) sinon.",
paste0("Niveau d’éducation : (0) faible [études secondaires ou moins] ; (1) moyen [études ",
"post-secondaires inférieures au baccalauréat] ; (2) élevé [diplôme de baccalauréat ",
"ou plus]"),
"Statut d’immigrant : (1) si la personne est immigrante ; (0) si la personne est née au Canada.",
"Statut de salarié : (1) si la personne perçoit un salaire ; (0) sinon.",
paste0("Statut de travailleur autonome : (1) si le répondant est travailleur autonome ; ",
"(0) s’il s’agit d’un employé."),
"Temps de travail : (1) temps partiel ; (0) temps plein.",
paste0("(1) Si la personne est membre d’un syndicat ou couverte par une convention collective ",
"négociée par un syndicat ; (0) sinon."),
paste0("Taille de l’entreprise employeuse : (1) pour les grandes firmes de plus de 500 employés",
"; (0) pour les plus petites entreprises."),
"(1) Si la personne est au chômage ; (0) sinon.",
"(1) Pour les personnes en recherche d’emploi depuis au moins 12 mois chômage long ; (0) sinon.",
paste0("Catégories professionnelles selon le système de classification nationale : (1) Gestion ",
"(2) Affaires, finance et administration (3) Sciences naturelles et appliquées et ",
"domaines apparentés (4) Secteur de la santé (5) Enseignement, droit et services ",
"sociaux, communautaires et gouvernementaux (6) Arts, culture, sports et loisirs ",
"(7) Vente et services (8) Métiers, transport, machinerie et domaines apparentés ",
"(9) Ressources naturelles, agriculture et production connexe ",
"(10) Fabrication et services d'utilité publique"),
"Salaire horaire habituel (en dollar canadien)",
"Durée de l'emploi avec l'employeur actuel (en années)"))
#kable(descrip, caption = "Description des variables", "simple")
descrip %>% regulartable() %>% autofit() %>% width(j=~Variable, width = 1) %>% width(j=~Description, width = 5.4) %>% set_caption("Description des variables") #for fitting PDF doc
# Lecture et visualisation de la base de donnees
load("../base.RData")
# Creation et formattage des variables
attach(base)
base$YOUNG <- factor(if_else(AGE < 3, 1, 0))
base$WOMAN <- factor(if_else(SEX == 1, 0, 1))
base$MARRIED <- factor(if_else(MARSTAT == 1, 1, 0))
base$EDUC.LEVEL <- factor(if_else(EDUC < 3, 0, if_else(EDUC < 5, 1, 2)))
base$IMMIGRANT <- factor(if_else(IMMIG != 3, 1, 0))
base$ISPAID <- factor(PAID)
base$SELF.EMP <- factor(if_else(CATWORK == 1, 0, 1))
base$PART.TIME <- factor(if_else(WTIME == 2, 1, 0))
base$SYNDIC <- factor(if_else(UNION != 3, 1, 0))
base$LARGFIRM <- factor(if_else(FIRMSIZE == 4, 1, 0))
base$ISUNEMP <- factor(UNEMP)
base$LONG.UNEMP <- factor(if_else(DURUNEMP >= 52, 1, 0))
base$OCCUP.SEC <- factor(OCCUP)
base$OCCUP.SEC <- factor(OCCUP, levels = c(7, 1, 2, 3, 4, 5, 6, 8, 9, 10))
base$SAL <- HRLYEARN/100
base$YRS.TENURE <- base$TENURE/12
base$PROVINCE <- factor(PROV, labels = c("Terre-Neuve-et-Labrador", "Île-du-Prince-Édouard", "Nouvelle-Écosse", "Nouveau-Brunswick",
"Québec", "Ontario", "Manitoba", "Saskatchewan", "Alberta", "Colombie-Britannique"))
base$LN.SAL <- log(base$SAL)
descrip <- data.frame(Variable=names(select(base,c(18:32))),
Description=c("Catégorie d’âge de l’individu : (1) si âgé de moins de 30 ans ; (0) sinon.",
"Genre femme : (1) s’il s’agit d’une femme ; (0) pour les hommes.",
"Statut matrimonial : (1) si marié ; (0) sinon.",
paste0("Niveau d’éducation : (0) faible [études secondaires ou moins] ; (1) moyen [études ",
"post-secondaires inférieures au baccalauréat] ; (2) élevé [diplôme de baccalauréat ",
"ou plus]"),
"Statut d’immigrant : (1) si la personne est immigrante ; (0) si la personne est née au Canada.",
"Statut de salarié : (1) si la personne perçoit un salaire ; (0) sinon.",
paste0("Statut de travailleur autonome : (1) si le répondant est travailleur autonome ; ",
"(0) s’il s’agit d’un employé."),
"Temps de travail : (1) temps partiel ; (0) temps plein.",
paste0("(1) Si la personne est membre d’un syndicat ou couverte par une convention collective ",
"négociée par un syndicat ; (0) sinon."),
paste0("Taille de l’entreprise employeuse : (1) pour les grandes firmes de plus de 500 employés",
"; (0) pour les plus petites entreprises."),
"(1) Si la personne est au chômage ; (0) sinon.",
"(1) Pour les personnes en recherche d’emploi depuis au moins 12 mois chômage long ; (0) sinon.",
paste0("Catégories professionnelles selon le système de classification nationale : (1) Gestion ",
"(2) Affaires, finance et administration (3) Sciences naturelles et appliquées et ",
"domaines apparentés (4) Secteur de la santé (5) Enseignement, droit et services ",
"sociaux, communautaires et gouvernementaux (6) Arts, culture, sports et loisirs ",
"(7) Vente et services (8) Métiers, transport, machinerie et domaines apparentés ",
"(9) Ressources naturelles, agriculture et production connexe ",
"(10) Fabrication et services d'utilité publique"),
"Salaire horaire habituel (en dollar canadien)",
"Durée de l'emploi avec l'employeur actuel (en années)"))
#kable(descrip, caption = "Description des variables", "simple")
descrip %>% regulartable() %>% autofit() %>% width(j=~Variable, width = 1) %>% width(j=~Description, width = 5.4) %>% set_caption("Description des variables") #for fitting PDF doc
baseQC <- base %>% filter(PROVINCE == "Québec") %>% select(c(18:32,34))
attach(baseQC)
stat1 <- data.frame(variable = c("YOUNG","WOMAN","MARRIED","EDUC.LEVEL_0","EDUC.LEVEL_1","EDUC.LEVEL_2","IMMIGRANT","ISPAID","SELF.EMP","PART.TIME","SYNDIC","LARGFIRM","ISUNEMP","LONG.UNEMP"), n = c(sum(YOUNG=='1', na.rm=TRUE),sum(WOMAN=='1', na.rm=TRUE),sum(MARRIED=='1', na.rm=TRUE),sum(EDUC.LEVEL=='0', na.rm=TRUE),sum(EDUC.LEVEL=='1', na.rm=TRUE),sum(EDUC.LEVEL=='2', na.rm=TRUE),sum(IMMIGRANT=='1', na.rm=TRUE),sum(ISPAID=='1', na.rm=TRUE),sum(SELF.EMP=='1', na.rm=TRUE),sum(PART.TIME=='1', na.rm=TRUE),sum(SYNDIC=='1', na.rm=TRUE),sum(LARGFIRM=='1', na.rm=TRUE),sum(ISUNEMP=='1', na.rm=TRUE),sum(LONG.UNEMP=='1', na.rm=TRUE)), prop_n = c(mean(YOUNG=='1', na.rm=TRUE),mean(WOMAN=='1', na.rm=TRUE),mean(MARRIED=='1', na.rm=TRUE),mean(EDUC.LEVEL=='0', na.rm=TRUE),mean(EDUC.LEVEL=='1', na.rm=TRUE),mean(EDUC.LEVEL=='2', na.rm=TRUE),mean(IMMIGRANT=='1', na.rm=TRUE),mean(ISPAID=='1', na.rm=TRUE),mean(SELF.EMP=='1', na.rm=TRUE),mean(PART.TIME=='1', na.rm=TRUE),mean(SYNDIC=='1', na.rm=TRUE),mean(LARGFIRM=='1', na.rm=TRUE),mean(ISUNEMP=='1', na.rm=TRUE),mean(LONG.UNEMP=='1', na.rm=TRUE)))
stat2 <- data.frame(variable = c("OCCUP.SEC1","OCCUP.SEC2","OCCUP.SEC3","OCCUP.SEC4","OCCUP.SEC5","OCCUP.SEC6","OCCUP.SEC7","OCCUP.SEC8","OCCUP.SEC9","OCCUP.SEC10"),
n = c(sum(OCCUP.SEC=='1', na.rm=TRUE),sum(OCCUP.SEC=='2', na.rm=TRUE),sum(OCCUP.SEC=='3', na.rm=TRUE),sum(OCCUP.SEC=='4', na.rm=TRUE),sum(OCCUP.SEC=='5', na.rm=TRUE),sum(OCCUP.SEC=='6', na.rm=TRUE),sum(OCCUP.SEC=='7', na.rm=TRUE),sum(OCCUP.SEC=='8', na.rm=TRUE),sum(OCCUP.SEC=='9', na.rm=TRUE),sum(OCCUP.SEC=='10', na.rm=TRUE)),
prop_n = c(mean(OCCUP.SEC=='1', na.rm=TRUE),mean(OCCUP.SEC=='2', na.rm=TRUE),mean(OCCUP.SEC=='3', na.rm=TRUE),mean(OCCUP.SEC=='4', na.rm=TRUE),mean(OCCUP.SEC=='5', na.rm=TRUE),mean(OCCUP.SEC=='6', na.rm=TRUE),mean(OCCUP.SEC=='7', na.rm=TRUE),mean(OCCUP.SEC=='8', na.rm=TRUE),mean(OCCUP.SEC=='9', na.rm=TRUE),mean(OCCUP.SEC=='10', na.rm=TRUE)))
stat3 <- data.frame(variable = c("SAL","YRS.TENURE"), moy = c(mean(SAL, na.rm=TRUE), mean(YRS.TENURE, na.rm=TRUE)), ecart_type = c(sd(SAL, na.rm=TRUE), sd(YRS.TENURE, na.rm=TRUE)))
#kables(list(kable(stat1) %>% kable_styling(), list(kable(stat2) %>% kable_styling(), kable(stat3) %>% kable_styling())), caption = "Statistique descriptive") %>% kable_styling()
kable(list(stat1, stat2, stat3), caption = 'Statistique descriptive', booktabs = TRUE, valign = 't')   #for fitting PDF doc
varACM <- subset.data.frame(baseQC,
select = c("WOMAN", "YOUNG", "MARRIED", "EDUC.LEVEL", "IMMIGRANT", "SELF.EMP", "SYNDIC", "OCCUP.SEC",
"PART.TIME", "LARGFIRM", "ISPAID", "ISUNEMP", "LONG.UNEMP", "YRS.TENURE", "SAL"))
res.mca <- MCA(varACM, quali.sup = c(6:13), quanti.sup = c(14, 15), graph = FALSE)
p0 <- plot(res.mca, invisible = c("ind", "var"), habillage = "quali", cex = 0.9, selectMod = "cos2 20")
p0 + labs(title = "Position des variables quali. supp. dans le plan ACM", caption = "©FRPDJ, Source:StatCan")
p1 <- plot(res.mca, invisible = c("ind", "quali.sup"), habillage = "quali", cex = 0.9, selectMod = "cos2 20")
p1 + labs(title = "Position des variables fondamentales dans le plan ACM", caption = "©FRPDJ, Source:StatCan")
mean_nat <- round(mean(baseQC$SAL[IMMIGRANT==0], na.rm = TRUE), 1)
mean_im <- round(mean(baseQC$SAL[IMMIGRANT==1], na.rm = TRUE), 1)
med_nat <- round(median(baseQC$SAL[IMMIGRANT==0], na.rm = TRUE), 1)
med_im <- round(median(baseQC$SAL[IMMIGRANT==1], na.rm = TRUE), 1)
tmoy <- t.test(baseQC$SAL ~ baseQC$IMMIGRANT)
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
print(paste("ttest : p-value = ", round(tmoy$p.value, 4)))
chom <- baseQC %>% group_by(IMMIGRANT, ISUNEMP) %>% summarise(n = n()) %>% group_by(IMMIGRANT) %>% summarise(ISUNEMP = ISUNEMP, n = n, prop = n/sum(n)) %>% filter(ISUNEMP==1)
rc_nat <- chom %>% filter(IMMIGRANT==0) %>% .$prop %>% percent()
rc_im <- chom %>% filter(IMMIGRANT==1) %>% .$prop %>% percent()
lchom <- baseQC %>% group_by(IMMIGRANT, LONG.UNEMP) %>% summarise(n = n()) %>% group_by(IMMIGRANT) %>% summarise(LONG.UNEMP = LONG.UNEMP, n = n, prop = n/sum(n)) %>% filter(LONG.UNEMP==1)
rlc_nat <- lchom %>% filter(IMMIGRANT==0) %>% .$prop %>% percent(0.1)
rlc_im <- lchom %>% filter(IMMIGRANT==1) %>% .$prop %>% percent(0.1)
x2_chom <- chisq.test(baseQC$IMMIGRANT, baseQC$ISUNEMP)
x2_lchom <- chisq.test(baseQC$IMMIGRANT, baseQC$LONG.UNEMP)
x2_chom_p <- round(x2_chom$p.value, 5)
x2_lchom_p <- round(x2_lchom$p.value, 4)
p4 <- chom %>% ggplot()
p4 + geom_bar(data = chom, aes(IMMIGRANT, prop, fill = "UNEMP"), stat = "identity", width = 0.9) +
geom_bar(data = lchom, aes(IMMIGRANT, prop, fill = "LONG UNEMP"), col = "gray", stat = "identity", width = 0.9) +
scale_fill_manual(name='', breaks=c('UNEMP', 'LONG UNEMP'), values=c('UNEMP'='#E69F00', 'LONG UNEMP'='#D55E00')) +
labs(title = "Proportion d'individus au chômage", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() +
scale_x_discrete(name="", labels=c("Canadian born", "Immigrant"))
print(paste("UNEMP: chi2 test p-value = ", x2_chom_p))
print(paste("LONG UNEMP: chi2 test p-value = ", x2_lchom_p))
baseQC.paid <- baseQC %>% filter(ISPAID == 1)  #Filtrage des donnees des salariés au Quebec
reg1 <- lm(LN.SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + IMMIGRANT + SELF.EMP + OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM, data = baseQC.paid)
sumreg1 <- summary(reg1)
conf1 <- data.frame(confint(reg1, level=0.95)) %>% rename(b_inf=X2.5.., b_sup= X97.5..)
t1 <- data.frame(variable = c("intercept", "YOUNG", "WOMAN", "MARRIED", "EDUC.LEVEL_1","EDUC.LEVEL_2", "IMMIGRANT", "SELF.EMP", "OCCUP.SEC_1",
"OCCUP.SEC_2", "OCCUP.SEC_3", "OCCUP.SEC_4", "OCCUP.SEC_5", "OCCUP.SEC_6", "OCCUP.SEC_8", "OCCUP.SEC_9",
"OCCUP.SEC_10", "PART.TIME", "YRS.TENURE", "SYNDIC", "LARGFIRM"), estim_coef = sumreg1$coefficients[ , 1], inf = conf1$b_inf,
sup = conf1$b_sup, p_value = sumreg1$coefficients[ , 4]) %>% mutate(sign = if_else(p_value < 10^-3,"*",if_else(p_value < .05,".",""))) %>%
filter(variable != "intercept") %>%
mutate(variable = reorder(variable, estim_coef, FUN = median))
p5 <- t1 %>% ggplot()
p5 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.2) +
theme_economist_white() + geom_hline(yintercept = 0, col="red") + scale_x_discrete(name = "") +
theme(axis.text.x = element_text(angle=90, hjust=1))
#effects <- round((exp(reg1$coefficients)-1)*100, 1) #effects on salary
#effects
reg2 <- lm(SAL ~ YOUNG + WOMAN + MARRIED + EDUC.LEVEL + IMMIGRANT + SELF.EMP + OCCUP.SEC + PART.TIME + YRS.TENURE + SYNDIC + LARGFIRM, data = baseQC.paid)
sumreg2 <- summary(reg2)
conf2 <- data.frame(confint(reg2, level=0.95)) %>% rename(b_inf=X2.5.., b_sup= X97.5..)
t2 <- data.frame(variable = c("intercept", "YOUNG", "WOMAN", "MARRIED", "EDUC.LEVEL_1","EDUC.LEVEL_2", "IMMIGRANT", "SELF.EMP", "OCCUP.SEC_1",
"OCCUP.SEC_2", "OCCUP.SEC_3", "OCCUP.SEC_4", "OCCUP.SEC_5", "OCCUP.SEC_6", "OCCUP.SEC_8", "OCCUP.SEC_9",
"OCCUP.SEC_10", "PART.TIME", "YRS.TENURE", "SYNDIC", "LARGFIRM"), estim_coef = sumreg2$coefficients[ , 1], inf = conf2$b_inf,
sup = conf2$b_sup, p_value = sumreg2$coefficients[ , 4]) %>% mutate(sign = if_else(p_value < 10^-3,"*",if_else(p_value < .05,".",""))) %>%
filter(variable != "intercept") %>%
mutate(variable = reorder(variable, estim_coef, FUN = median))
p6 <- t2 %>% ggplot()
p6 + geom_point(aes(x = variable, y = estim_coef), size = 2, col = "darkblue") + geom_text(aes(x = variable, y = estim_coef, label=sign), nudge_x = .2, nudge_y = 0) + geom_errorbar(aes(x = variable, y = estim_coef, ymin = inf, ymax = sup), col = "darkblue", width=.2) +
theme_economist_white() + geom_hline(yintercept = 0, col="red") + scale_x_discrete(name = "") +
theme(axis.text.x = element_text(angle=90, hjust=1))
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-EPA-04-2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Wage Density Curve in Quebec)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly Wage Density Curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
savePlot(filename = "plot/wage_density", type = "png")
Plot will add the file type as an
savePlot(filename = p3, type = "png")
savePlot(filename = "wage_density", type = "png")
savePlot(filename = "plot/wage_density", type = "png")
png(file = "plot/wage_density.png")
dev.off()
png(file = "plot/wage_density.png")
dev.off()
png(file = "plot/wage_density.png")
png(p3, file = "plot/wage_density.png")
png(file = "plot/wage_density.png")
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
dev.off()
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p <- p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
png(file = "plot/wage_density.png")
p
dev.off()
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
png(file = "plot/wage_density.png")
p
dev.off()
p
png(file = "plot/wage_density.png")
p
dev.off()
png(file = "plot/wage_density.png", width = 4, height = 4)
png(file = "plot/wage_density.png", width = 600, height = 600)
p
dev.off()
png(file = "plot/wage_density.png", width = 650, height = 650)
p
dev.off()
png(file = "plot/wage_density.png", width = 650, height = 450)
p
dev.off()
png(file = "plot/wage_density.png", width = 1280, height = 740)
p
dev.off()
png(file = "plot/wage_density.png", width = 1280/2, height = 740/2)
p
dev.off()
p
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text = element_text(size = 12))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text = element_text(size = 12))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 12))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.key.size = 11)
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.key.size = element_text(size = 11))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.text = element_text(size = 11))
p <- p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.text = element_text(size = 11))
png(file = "plot/wage_density.png", width = 1280/2, height = 740/2)
p
dev.off()
p
p2 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(IMMIGRANT,SAL, fill = IMMIGRANT))
p2 + geom_boxplot() + labs(title = "Distribution des salaires (boîtes à moustaches)", caption = "©FRPDJ, Source:StatCan") + theme_fivethirtyeight() + theme(legend.position="none") + scale_x_discrete(name="", labels=c("Canadian born", "Immigrant")) + geom_hline(yintercept = mean_nat, col = "red") +
geom_text(aes(x=0.51, y=mean_nat+2, label="mean CB", col="c")) + geom_hline(yintercept = mean_im, col = "blue") +
geom_text(aes(x=2.5, y=mean_im-2, label="mean IM", col="i"))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Distribution des salaires (courbes de densité)", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,30,52,65,92))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, fill = IMMIGRANT))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,20,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.text = element_text(size = 11))
p3 + geom_density(alpha=0.2, bw=2, position = "nudge") + scale_fill_discrete(name = "", labels = c("Canadian born", "Immigrant")) + labs(title = "Hourly wage density curve in Quebec", caption = "©FRPDJ, Source:StatCan-04/2022") + theme_fivethirtyeight() + scale_x_continuous(breaks = c(0,9,14,20,30,52,65,92)) + theme(axis.text.x = element_text(size = 11), axis.text.y = element_text(size = 11), legend.text = element_text(size = 11))
p3 + stat_ecdf()
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, col = IMMIGRANT))
p3 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, col = IMMIGRANT))
p3 + stat_ecdf()
p3 + stat_ecdf(bw=2)
p3 + stat_ecdf(bw=.5)
p3 + stat_ecdf(bw=10)
p3 + stat_ecdf(bw=100)
p4 + stat_ecdf(na.rm = TRUE)
p4 <- baseQC %>% group_by(IMMIGRANT) %>% ggplot(aes(SAL, col = IMMIGRANT))
p4 + stat_ecdf(na.rm = TRUE)
p4 + stat_ecdf(na.rm = TRUE) + coord_flip()
p4 + stat_ecdf(na.rm = TRUE)
p4 + stat_ecdf(na.rm = TRUE) + scale_x_continous(expand=c(0,0))
p4 + stat_ecdf(na.rm = TRUE) + scale_x_continuous(expand=c(0,0))
p4 + stat_ecdf(na.rm = TRUE)
p4 + stat_ecdf(na.rm = TRUE) + scale_x_continuous(expand=c(0,0))
p4 + stat_ecdf(na.rm = TRUE)
p4 + stat_ecdf(na.rm = TRUE) + scale_x_continuous(expand=c(0,0))
p4 + stat_ecdf(na.rm = TRUE) + scale_x_reverse()
